<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://cdnjs.cloudflare.com https://translate.terraprint.co https://viacep.com.br https://ipapi.co https://api.allorigins.win https://api.exchangerate.host 'unsafe-inline';">
    <meta http-equiv="Referrer-Policy" content="no-referrer">
    <meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains">
    <title>WolfGuard AI</title>
    <link rel="icon" href="favicon2.png" type="image/x-icon" />
    <link rel="shortcut icon" href="favicon2.png" type="image/x-icon" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        :root {
            --primary: #4a00e0;
            --secondary: #8e2de2;
            --text: #f8f8f8;
            --bg: #0a0a14;
            --card: #12121e;
            --accent: #00c9ff;
            --snow-color: #00a8ff;
            --sidebar-width: 300px;
            --sidebar-width-collapsed: 0px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--bg);
            color: var(--text);
            overflow-x: hidden;
        }
        
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
            position: relative;
        }
        
        .sidebar {
            width: var(--sidebar-width);
            background-color: rgba(18, 18, 30, 0.8);
            backdrop-filter: blur(10px);
            padding: 20px;
            display: flex;
            flex-direction: column;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            position: fixed;
            height: 100%;
            z-index: 100;
            transition: transform 0.3s ease, width 0.3s ease;
            overflow-y: auto;
        }
        
        .sidebar.collapsed {
            transform: translateX(-100%);
        }

        .mobile-header {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 15px;
            background-color: rgba(18, 18, 30, 0.8);
            backdrop-filter: blur(10px);
            z-index: 99;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .mobile-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .menu-toggle {
            background: none;
            border: none;
            color: var(--accent);
            font-size: 24px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mobile-logo {
            display: flex;
            align-items: center;
        }
        
        .mobile-logo img {
            width: 32px;
            height: 32px;
            margin-right: 10px;
        }
        
        .mobile-logo h1 {
            font-size: 20px;
            background: linear-gradient(to right, var(--accent), var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }
        
        .logo {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .logo img {
            width: 40px;
            height: 40px;
            margin-right: 10px;
        }
        
        .logo h1 {
            font-size: 24px;
            background: linear-gradient(to right, var(--accent), var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }
        
        .menu {
            flex: 1;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border-radius: 10px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .menu-item:hover {
            background-color: rgba(74, 0, 224, 0.2);
        }
        
        .menu-item.active {
            background-color: rgba(74, 0, 224, 0.3);
        }
        
        .menu-item i {
            margin-right: 10px;
            font-size: 20px;
            color: var(--accent);
        }
        
        .main {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            margin-left: var(--sidebar-width);
            width: calc(100% - var(--sidebar-width));
            transition: margin-left 0.3s ease, width 0.3s ease;
        }
        
        .main.expanded {
            margin-left: var(--sidebar-width-collapsed);
            width: 100%;
        }

        .main.mobile-view {
            margin-top: 70px;
        }
        
        .tab-container {
            display: none;
            flex: 1;
            flex-direction: column;
            height: calc(100vh - 40px);
        }
        
        .tab-container.active {
            display: flex;
        }
        
        .chat-container {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            height: calc(100% - 100px);
            overflow-x: hidden;
        }
        
        .message {
            max-width: 80%;
            padding: 15px;
            border-radius: 10px;
            animation: fadeIn 0.5s ease;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        .user {
            align-self: flex-end;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
        }
        
        .ai {
            align-self: flex-start;
            background-color: var(--card);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .input-container {
            position: sticky;
            bottom: 0;
            padding: 7px;
            background-color: var(--card);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: auto;
            z-index: 10;
        }
        
        .input-container textarea {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 10px;
            background-color: transparent;
            color: var(--text);
            resize: none;
            outline: none;
            font-size: 16px;
            max-height: 56px;
            overflow-y: auto;
        }
        
        .input-buttons {
            display: flex;
            justify-content: space-between;
            padding: 10px;
        }
        
        .tools {
            display: flex;
            gap: 10px;
        }
        
        .tools button {
            background-color: transparent;
            border: none;
            color: var(--accent);
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .tools button:hover {
            color: var(--primary);
        }
        
        .send-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 0, 224, 0.3);
        }
        
        .search-box {
            background-color: var(--card);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .search-box input {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text);
            font-size: 16px;
            outline: none;
        }
        
        .search-box button {
            margin-top: 10px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            color: white;
            padding: 12px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
        }
        
        .result-container {
            background-color: var(--card);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            flex: 1;
            overflow-y: auto;
        }
        
        .result-card {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeIn 0.5s ease;
        }
        
        .result-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--accent);
        }
        
        .result-data {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .data-item {
            display: flex;
            justify-content: space-between;
        }
        
        .data-label {
            font-weight: 600;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .data-value {
            color: var(--text);
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0% {
                opacity: 0.6;
            }
            50% {
                opacity: 1;
            }
            100% {
                opacity: 0.6;
            }
        }
        
        .visualizer {
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .bar {
            width: 5px;
            background-color: var(--accent);
            border-radius: 5px;
            animation: pulse 1s infinite;
        }
        
        .bar:nth-child(1) {
            height: 15px;
            animation-delay: 0.1s;
        }
        
        .bar:nth-child(2) {
            height: 25px;
            animation-delay: 0.2s;
        }
        
        .bar:nth-child(3) {
            height: 35px;
            animation-delay: 0.3s;
        }
        
        .bar:nth-child(4) {
            height: 25px;
            animation-delay: 0.4s;
        }
        
        .bar:nth-child(5) {
            height: 15px;
            animation-delay: 0.5s;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-content {
            background-color: var(--card);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: var(--accent);
        }
        
        .modal-title {
            font-size: 24px;
            margin-bottom: 20px;
            background: linear-gradient(to right, var(--accent), var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .settings-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .form-group label {
            font-weight: 600;
        }
        
        .form-group input, .form-group select {
            padding: 12px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: var(--text);
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.1);
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--primary);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .save-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            color: white;
            padding: 12px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 10px;
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: none;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .menu-item i.fa-square, 
        .menu-item i.fa-square-full {
            border-radius: 50%;
        }
        
        .snowflake {
            position: absolute;
            background-color: var(--snow-color);
            border-radius: 50%;
            opacity: 0.8;
            pointer-events: none;
        }

        .mobile-actions {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
        }
        
        .mobile-action-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            border: none;
            cursor: pointer;
        }
        
        .mobile-menu {
            display: none;
            position: absolute;
            bottom: 60px;
            right: 0;
            background-color: var(--card);
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .mobile-menu-item {
            padding: 10px;
            display: flex;
            align-items: center;
            white-space: nowrap;
            cursor: pointer;
        }
        
        .mobile-menu-item i {
            margin-right: 10px;
            color: var(--accent);
        }
        
        .mobile-menu-item:hover {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
        }
        
        select option {
            background-color: var(--card);
            color: var(--text);
        }
        
        @media (max-width: 992px) {
            .sidebar {
                width: 280px;
            }
            
            .main {
                margin-left: 280px;
                width: calc(100% - 280px);
            }
        }
        
        @media (max-width: 768px) {
            .mobile-header {
                display: block;
            }
            
            .sidebar {
                transform: translateX(-100%);
                width: 280px;
                z-index: 101;
                top: 70px;
                height: calc(100% - 70px);
            }
            
            .sidebar.mobile-open {
                transform: translateX(0);
            }
            
            .main {
                margin-left: 0;
                width: 100%;
                margin-top: 70px;
            }
            
            .main.mobile-view {
                margin-top: 70px;
            }
            
            .data-item {
                flex-direction: column;
                gap: 5px;
            }
            
            .message {
                max-width: 90%;
            }
            
            .mobile-actions {
                display: block;
            }
            
            .modal-content {
                width: 95%;
                padding: 20px;
            }
            
            .tab-container {
                height: calc(100vh - 110px);
            }
        }
        
        @media (max-width: 480px) {
            .tools {
                gap: 5px;
            }
            
            .tools button {
                font-size: 16px;
            }
            
            .send-btn {
                padding: 5px 12px;
                font-size: 14px;
            }
            
            .message {
                max-width: 95%;
                padding: 12px;
            }
            
            .mobile-logo h1 {
                font-size: 18px;
            }
            
            .mobile-logo img {
                width: 28px;
                height: 28px;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div id="canvas-container"></div>
    
    <div class="mobile-header">
        <div class="mobile-header-content">
            <button class="menu-toggle" id="mobile-menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            <div class="mobile-logo">
                <img src="favicon2.png">
                <h1>WolfGuard AI</h1>
            </div>
            <button class="menu-toggle" id="mobile-options-toggle">
                <i class="fas fa-ellipsis-v"></i>
            </button>
        </div>
    </div>
    
    <div class="container">
        <div class="sidebar" id="sidebar">
            <div class="logo">
                <img src="favicon2.png">
                <h1>WolfGuard AI</h1>
            </div>
            
            <div class="menu">
                <div class="menu-item active" data-tab="chat">
                    <i class="fas fa-comment-alt"></i>
                    Chat AI
                </div>

                <div class="menu-item" data-tab="ip">
                    <i class="fas fa-network-wired"></i>
                    Análise de IP
                </div>
                <div class="menu-item" data-tab="address">
                    <i class="fas fa-map-marker-alt"></i>
                    Consulta CEP
                </div>
                <div class="menu-item" data-tab="translate">
                    <i class="fas fa-language"></i>
                    Tradutor
                </div>
                <div class="menu-item" data-tab="security">
                    <i class="fas fa-shield-alt"></i>
                    Segurança
                </div>
                <div class="menu-item" data-tab="currency">
                    <i class="fas fa-money-bill-wave"></i>
                    Conversão de Moeda
                </div>
            </div>
            
            <div class="menu-item" id="settings-btn">
                <i class="fas fa-cog"></i>
                Configurações
            </div>
        </div>
        
        <div class="main" id="main">
            <div class="tab-container active" id="chat-tab">
                <div class="chat-container" id="chat-messages">
                    <div class="message ai">
                        <p>Olá! Sou o WolfGuard AI, sua assistente de inteligência artificial. Como posso ajudar você hoje?</p>
                    </div>
                </div>
                
                <div class="input-container">
                    <textarea placeholder="Digite sua mensagem aqui..." rows="1" id="chat-input"></textarea>
                    <div class="input-buttons">
                        <div class="tools">
                            <button id="mic-btn"><i class="fas fa-microphone"></i></button>
                            <button id="attach-btn"><i class="fas fa-paperclip"></i></button>
                            <button id="img-btn"><i class="fas fa-image"></i></button>
                        </div>
                        <button class="send-btn" id="send-btn">Enviar</button>
                    </div>
                </div>
            </div>
            
            <div class="tab-container" id="ip-tab">
                <div class="search-box">
                    <input type="text" placeholder="Digite um endereço IP..." id="ip-input">
                    <button id="analyze-ip">Analisar IP</button>
                </div>
                
                <div class="result-container" id="ip-results">
                    <div class="loading" id="ip-loading" style="display: none;">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>
            
            <div class="tab-container" id="address-tab">
                <div class="search-box">
                    <input type="text" placeholder="Digite um CEP..." id="cep-input">
                    <button id="search-cep">Buscar CEP</button>
                </div>
                
                <div class="result-container" id="cep-results">
                    <div class="loading" id="cep-loading" style="display: none;">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>
            
            <div class="tab-container" id="translate-tab">
                <div class="search-box">
                    <textarea placeholder="Digite o texto para traduzir..." rows="5" id="translate-input" style="width: 100%; resize: none;"></textarea>
                    <div style="display: flex; gap: 10px; margin: 10px 0;">
                        <select id="from-lang" style="flex: 1; padding: 10px; background: rgba(255,255,255,0.1); color: white; border: none; border-radius: 5px;">
                            <option value="pt">Português</option>
                            <option value="en">Inglês</option>
                            <option value="es">Espanhol</option>
                            <option value="fr">Francês</option>
                            <option value="de">Alemão</option>
                            <option value="it">Italiano</option>
                            <option value="ja">Japonês</option>
                            <option value="ko">Coreano</option>
                            <option value="zh">Chinês</option>
                            <option value="ru">Russo</option>
                        </select>
                        <button id="switch-lang" style="background: none; border: none; color: white; font-size: 20px;"><i class="fas fa-exchange-alt"></i></button>
                        <select id="to-lang" style="flex: 1; padding: 10px; background: rgba(255,255,255,0.1); color: white; border: none; border-radius: 5px;">
                            <option value="en">Inglês</option>
                            <option value="pt">Português</option>
                            <option value="es">Espanhol</option>
                            <option value="fr">Francês</option>
                            <option value="de">Alemão</option>
                            <option value="it">Italiano</option>
                            <option value="ja">Japonês</option>
                            <option value="ko">Coreano</option>
                            <option value="zh">Chinês</option>
                            <option value="ru">Russo</option>
                        </select>
                    </div>
                    <button id="translate-btn">Traduzir</button>
                </div>
                
                <div class="result-container" id="translate-results">
                    <div class="loading" id="translate-loading" style="display: none;">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>
            
            <div class="tab-container" id="security-tab">
                <div class="search-box">
                    <input type="text" placeholder="Digite o nome de um aplicativo ou ameaça..." id="security-input">
                    <button id="analyze-threat">Analisar Segurança</button>
                </div>
                
                <div class="result-container" id="security-results">
                    <div class="loading" id="security-loading" style="display: none;">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>
            
            <div class="tab-container" id="currency-tab">
                <div class="search-box">
                    <div style="display: flex; margin-bottom: 15px;">
                        <input type="number" placeholder="Valor" id="currency-amount" style="flex: 2; padding: 12px; border: none; border-radius: 5px; background-color: rgba(255, 255, 255, 0.1); color: var(--text); margin-right: 10px;">
                        <select id="from-currency" style="flex: 1; padding: 10px; background: rgba(255,255,255,0.1); color: white; border: none; border-radius: 5px;">
                            <option value="BRL">Real (BRL)</option>
                            <option value="USD">Dólar (USD)</option>
                            <option value="EUR">Euro (EUR)</option>
                            <option value="GBP">Libra (GBP)</option>
                            <option value="JPY">Iene (JPY)</option>
                            <option value="CNY">Yuan (CNY)</option>
                            <option value="ARS">Peso Argentino (ARS)</option>
                            <option value="CAD">Dólar Canadense (CAD)</option>
                            <option value="AUD">Dólar Australiano (AUD)</option>
                            <option value="CHF">Franco Suíço (CHF)</option>
                        </select>
                    </div>
                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                        <div style="flex: 1; height: 1px; background: rgba(255,255,255,0.1);"></div>
                        <button id="swap-currency" style="background: none; border: none; color: white; font-size: 20px; margin: 0 15px;"><i class="fas fa-exchange-alt"></i></button>
                        <div style="flex: 1; height: 1px; background: rgba(255,255,255,0.1);"></div>
                    </div>
                    <div style="display: flex; margin-bottom: 15px;">
                        <input type="number" placeholder="Resultado" id="currency-result" readonly style="flex: 2; padding: 12px; border: none; border-radius: 5px; background-color: rgba(255, 255, 255, 0.1); color: var(--text); margin-right: 10px;">
                        <select id="to-currency" style="flex: 1; padding: 10px; background: rgba(255,255,255,0.1); color: white; border: none; border-radius: 5px;">
                            <option value="USD">Dólar (USD)</option>
                            <option value="BRL">Real (BRL)</option>
                            <option value="EUR">Euro (EUR)</option>
                            <option value="GBP">Libra (GBP)</option>
                            <option value="JPY">Iene (JPY)</option>
                            <option value="CNY">Yuan (CNY)</option>
                            <option value="ARS">Peso Argentino (ARS)</option>
                            <option value="CAD">Dólar Canadense (CAD)</option>
                            <option value="AUD">Dólar Australiano (AUD)</option>
                            <option value="CHF">Franco Suíço (CHF)</option>
                        </select>
                    </div>
                    <button id="convert-currency">Converter</button>
                </div>
                
                <div class="result-container" id="currency-history">
                    <div class="loading" id="currency-loading" style="display: none;">
                        <div class="spinner"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-title">Histórico de Conversões</div>
                        <div id="currency-history-list" style="margin-top: 15px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-actions">
        <button class="mobile-action-btn" id="mobile-action-toggle">
            <i class="fas fa-ellipsis-v"></i>
        </button>
        <div class="mobile-menu" id="mobile-action-menu">
            <div class="mobile-menu-item" data-tab="chat">
                <i class="fas fa-comment-alt"></i>
                Chat AI
            </div>

            <div class="mobile-menu-item" data-tab="ip">
                <i class="fas fa-network-wired"></i>
                Análise de IP
            </div>
            <div class="mobile-menu-item" data-tab="address">
                <i class="fas fa-map-marker-alt"></i>
                Consulta CEP
            </div>
            <div class="mobile-menu-item" data-tab="translate">
                <i class="fas fa-language"></i>
                Tradutor
            </div>
            <div class="mobile-menu-item" data-tab="security">
                <i class="fas fa-shield-alt"></i>
                Segurança
            </div>
            <div class="mobile-menu-item" data-tab="currency">
                <i class="fas fa-money-bill-wave"></i>
                Conversão de Moeda
            </div>
            <div class="mobile-menu-item" id="mobile-settings-btn">
                <i class="fas fa-cog"></i>
                Configurações
            </div>
        </div>
    </div>
    
    <div class="modal" id="settings-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 class="modal-title">Configurações</h2>
            
            <div class="settings-form">
                <div class="form-group">
                    <label>Modelo de IA</label>
                    <select id="ai-model">
                        <option value="wolfguard-3">WolfGuard 3.0 (Recomendado)</option>
                        <option value="wolfguard-2">WolfGuard 2.0</option>
                        <option value="wolfguard-1">WolfGuard 1.0</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Temperatura</label>
                    <input type="range" min="0" max="100" value="70" id="temperature">
                </div>
                
                <div class="form-group">
                    <label>Modo escuro</label>
                    <label class="switch">
                        <input type="checkbox" checked id="dark-mode">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label>Animações 3D</label>
                    <label class="switch">
                        <input type="checkbox" checked id="toggle-3d">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label>Neve Azul</label>
                    <label class="switch">
                        <input type="checkbox" checked id="toggle-snow">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <button class="save-btn">Salvar configurações</button>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification">
        Configurações salvas com sucesso!
    </div>
    
    <script>
        let scene, camera, renderer, particles, raycaster, mouse;
        let animationId;
        let snowflakes = [];
        let snowEnabled = true;
        let isMobile = window.innerWidth <= 768;
        let isMobileMenuOpen = false;

        function initThreeJS() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            raycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();

            renderer = new THREE.WebGLRenderer({ alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            document.getElementById('canvas-container').appendChild(renderer.domElement);

            createParticles();
            createLights();
            createSnow();

            camera.position.z = 30;

            animate();
            window.addEventListener('resize', onWindowResize);
            window.addEventListener('mousemove', onMouseMove);
        }

        function createParticles() {
            const particleCount = isMobile ? 500 : 1000;
            const geometry = new THREE.BufferGeometry();
            const positions = new Float32Array(particleCount * 3);
            const colors = new Float32Array(particleCount * 3);
            const sizes = new Float32Array(particleCount);

            const color1 = new THREE.Color(0x4a00e0);
            const color2 = new THREE.Color(0x00c9ff);

            for (let i = 0; i < particleCount; i++) {
                const i3 = i * 3;
                positions[i3] = (Math.random() - 0.5) * 100;
                positions[i3 + 1] = (Math.random() - 0.5) * 100;
                positions[i3 + 2] = (Math.random() - 0.5) * 50;

                const mixedColor = color1.clone().lerp(color2, Math.random());
                colors[i3] = mixedColor.r;
                colors[i3 + 1] = mixedColor.g;
                colors[i3 + 2] = mixedColor.b;

                sizes[i] = Math.random() * 2;
            }

            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            geometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1));

            const texture = new THREE.TextureLoader().load('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFFmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTktMDEtMTJUMTU6MzM6MzctMDg6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE5LTAxLTEyVDE1OjM0OjItMDg6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTktMDEtMTJUMTU6MzQ6Mi0wODowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpkMGNiNWM2YS1mZTBhLTQzZDYtYWIyMC1hNWEwOGM2M2I1ZmMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ZDBjYjVjNmEtZmUwYS00M2Q2LWFiMjAtYTVhMDhjNjNiNWZjIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZDBjYjVjNmEtZmUwYS00M2Q2LWFiMjAtYTVhMDhjNjNiNWZjIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpkMGNiNWM2YS1mZTBhLTQzZDYtYWIyMC1hNWEwOGM2M2I1ZmMiIHN0RXZ0OndoZW49IjIwMTktMDEtMTJUMTU6MzM6MzctMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE4IChNYWNpbnRvc2gpIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PtI7CRIMINAL8zQxO7FWx2sFu/eDsUXFxewl8AAAN9SURBVFiF7ZdNiFtVGIaf5OaSSTLJZDITZypOO5XUsY5a0dZfLFJbwYUiKm6EFQW3unGrCCIIggsXunKhCMWFLgRRRBSKtVVUtHa0bR3H2s70N5PJ/N57jopiSGq8uRlH3PTA4X7n4/u+97zvd86BHewExksWkzl+sWp3s5Glh+a+PbmyxZ0/4JXh83GxKB2sZltWnlQuhyXOCVn6YjXmrFdyLgKXvWtKutA5U3XUVk7OZ/ng9EYAGjm+eFbUoZKXMunOoRbPCUCxWmPh03eGDWyFa2XpXxdnRsgnfTCxlN2qlrq4BVqeP5Ckd2ZF3L+a5eOtjCBRCpJVJevTJj4pK+mfxYS+2VyWcEE1xM9Fcm7cLAFcZ/BgGHHwZHWOe3o9XomqNLLk1TDgI0nZ9RvZ/l5O6I+CwcRzwjcbX3OTKnTJG68c5bxOmzddxJ3djDPD42WHZW2YLYb8iFDPkjcPz/Lxn6M4pBfjlJudHnM65lDa5eV6ytIwaWjYHnC85PJuxeWRQ19fePBmKeAHY05nQuwwJTzVdXnWmGFaRpzdPsbJdsxTacpCucQHR8Z5Xws8uVLlZd/lnaTHt2HEKS/kqU6XkzJizJpzyQsYMyWPiCrnNxw8mBccLYf8KlX6WCF9rpQJJ0RExfaZsAOmtOIFKXl7aczFm2GK7bNXWdz2z7mZddl/eMXmW2HS04oHpcVLQYl3RciTtRYP1Nv81Y+ZtBSXZ4pUJfSMoql6vJYrDl3t4CcJY1JQ0Q63yYgjlsWUzMPxiMNqMC6KvNLsMO8olrIfg8kQbgxkArYlmLElc1LSyxP6Wn+o8B/+V2sA4OJ+wokWRHuqJwAuLnLvMEyPCK0O5pn4Q2PuRX/1r4Z9TTSsMgEzQHmeB+Ob8Ro2c1nIrlRkZLpVs4sCHgbsBWaB+qj0HMJm5hLIr0GYgvhb7BbwK7AMtEa1/MV/gDlGkEMmMJMDVMiLXBSJUt3sFwu2J2C1A0IUkwDniEzJpYJ+xAaUFHIQd3ILF8c6KQQ6ABWC6YGugwmvDTuxIGMdcNctlCNz0C3ow9+DkP64A5u2bDTiYfTYdIH/iF3/Pf8BMbGwd4H58J8AAAAASUVORK5CYII=');
            
            const material = new THREE.PointsMaterial({
                size: 0.5,
                vertexColors: true,
                transparent: true,
                opacity: 0.8,
                sizeAttenuation: true,
                map: texture,
                alphaTest: 0.5
            });

            particles = new THREE.Points(geometry, material);
            scene.add(particles);
        }

        function createLights() {
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);

            const pointLight1 = new THREE.PointLight(0x4a00e0, 1, 100);
            pointLight1.position.set(10, 10, 10);
            scene.add(pointLight1);

            const pointLight2 = new THREE.PointLight(0x00c9ff, 1, 100);
            pointLight2.position.set(-10, -10, 10);
            scene.add(pointLight2);
        }
        
        function createSnow() {
            const snowCount = isMobile ? 100 : 200;
            const snowColor = new THREE.Color(0x00a8ff);
            
            for (let i = 0; i < snowCount; i++) {
                const snowGeometry = new THREE.CircleGeometry(Math.random() * 0.2 + 0.1, 32);
                const snowMaterial = new THREE.MeshBasicMaterial({
                    color: snowColor,
                    transparent: true,
                    opacity: Math.random() * 0.5 + 0.3
                });
                
                const snowflake = new THREE.Mesh(snowGeometry, snowMaterial);
                
                snowflake.position.x = (Math.random() - 0.5) * 100;
                snowflake.position.y = (Math.random() - 0.5) * 100 + 50;
                snowflake.position.z = (Math.random() - 0.5) * 50 - 10;
                
                snowflake.userData = {
                    speed: Math.random() * 0.05 + 0.02,
                    rotationSpeed: Math.random() * 0.02 - 0.01,
                    horizontalSpeed: Math.random() * 0.01 - 0.005
                };
                
                scene.add(snowflake);
                snowflakes.push(snowflake);
            }
        }

        function animate() {
            animationId = requestAnimationFrame(animate);

            const positions = particles.geometry.attributes.position.array;
            const sizes = particles.geometry.attributes.size.array;

            for (let i = 0; i < positions.length; i += 3) {
                positions[i + 1] += Math.sin(Date.now() * 0.001 + i) * 0.01;
                positions[i] += Math.cos(Date.now() * 0.001 + i) * 0.01;
                positions[i + 2] += Math.sin(Date.now() * 0.0005 + i) * 0.01;

                const size = (Math.sin(Date.now() * 0.001 + i) + 1.5) * 0.5;
                sizes[i / 3] = size;
            }

            particles.geometry.attributes.position.needsUpdate = true;
            particles.geometry.attributes.size.needsUpdate = true;

            particles.rotation.y += 0.001;
            particles.rotation.x += 0.0005;
            
            if (snowEnabled) {
                for (let i = 0; i < snowflakes.length; i++) {
                    const snowflake = snowflakes[i];
                    snowflake.position.y -= snowflake.userData.speed;
                    snowflake.position.x += snowflake.userData.horizontalSpeed;
                    snowflake.rotation.z += snowflake.userData.rotationSpeed;
                    
                    if (snowflake.position.y < -50) {
                        snowflake.position.y = 50;
                        snowflake.position.x = (Math.random() - 0.5) * 100;
                    }
                }
            }

            renderer.render(scene, camera);
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            
            const wasMobile = isMobile;
            isMobile = window.innerWidth <= 768;
            
            if (wasMobile !== isMobile) {
                updateMobileInterface();
            }
        }

        function updateMobileInterface() {
            const sidebar = document.getElementById('sidebar');
            const main = document.getElementById('main');
            
            if (isMobile) {
                sidebar.classList.remove('collapsed');
                sidebar.classList.remove('mobile-open');
                main.classList.add('mobile-view');
                main.classList.remove('expanded');
            } else {
                sidebar.classList.remove('mobile-open');
                main.classList.remove('mobile-view');
                main.classList.remove('expanded');
            }
        }

        function onMouseMove(event) {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

            raycaster.setFromCamera(mouse, camera);
            particles.rotation.y = mouse.x * 0.1;
            particles.rotation.x = mouse.y * 0.1;
        }

        function stopAnimation() {
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
        }

        function startAnimation() {
            if (!animationId) {
                animate();
            }
        }
        
        function toggleSnow(enabled) {
            snowEnabled = enabled;
            snowflakes.forEach(snowflake => {
                snowflake.visible = enabled;
            });
        }

        function calculateMathExpression(expression) {
            expression = expression.trim();
            
            if (expression.endsWith("=")) {
                expression = expression.slice(0, -1).trim();
            }
            
            try {
                const sanitizedExpression = expression
                    .replace(/[^0-9+\-*/().%\s]/g, "")
                    .replace(/\s+/g, "");
                
                if (!sanitizedExpression) {
                    return "Expressão inválida";
                }
                
                return new Function('return ' + sanitizedExpression)();
            } catch (error) {
                return "Erro ao calcular expressão";
            }
        }
        
        function getTime(city) {
            const now = new Date();
            
            const timezones = {
                "acre": -5,
                "rio branco": -5,
                "amazonas": -4,
                "manaus": -4,
                "roraima": -4,
                "boa vista": -4,
                "rondônia": -4,
                "porto velho": -4,
                "pará": -3,
                "belém": -3,
                "amapá": -3,
                "macapá": -3,
                "maranhão": -3,
                "são luís": -3,
                "piauí": -3,
                "teresina": -3,
                "ceará": -3,
                "fortaleza": -3,
                "rio grande do norte": -3,
                "natal": -3,
                "paraíba": -3,
                "joão pessoa": -3,
                "pernambuco": -3,
                "recife": -3,
                "alagoas": -3,
                "maceió": -3,
                "sergipe": -3,
                "aracaju": -3,
                "bahia": -3,
                "salvador": -3,
                "mato grosso": -4,
                "cuiabá": -4,
                "mato grosso do sul": -4,
                "campo grande": -4,
                "goiás": -3,
                "goiânia": -3,
                "distrito federal": -3,
                "brasília": -3,
                "tocantins": -3,
                "palmas": -3,
                "minas gerais": -3,
                "belo horizonte": -3,
                "espírito santo": -3,
                "vitória": -3,
                "rio de janeiro": -3,
                "são paulo": -3,
                "paraná": -3,
                "curitiba": -3,
                "santa catarina": -3,
                "florianópolis": -3,
                "rio grande do sul": -3,
                "porto alegre": -3,
                "fernando de noronha": -2
            };
            
            let offset = -3;
            
            if (city) {
                const lowercaseCity = city.toLowerCase();
                
                for (const [key, value] of Object.entries(timezones)) {
                    if (lowercaseCity.includes(key)) {
                        offset = value;
                        break;
                    }
                }
            }
            
            const localTime = new Date(now.getTime() + (now.getTimezoneOffset() * 60000) + (offset * 3600000));
            return localTime.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
        }

        async function translateText(text, fromLang, toLang) {
            if (fromLang === toLang) return text;
            
            const translateAPIs = [
                {
                    url: 'https://translate.terraprint.co/translate',
                    method: 'POST',
                    body: (text, fromLang, toLang) => JSON.stringify({
                        q: text,
                        source: fromLang,
                        target: toLang,
                        format: "text"
                    }),
                    extractResult: (data) => data.translatedText
                },
                {
                    url: 'https://api.allorigins.win/get?url=' + encodeURIComponent('https://translate.googleapis.com/translate_a/single?client=gtx&sl=' + fromLang + '&tl=' + toLang + '&dt=t&q=' + encodeURIComponent(text)),
                    method: 'GET',
                    extractResult: (data) => {
                        try {
                            const parsed = JSON.parse(data.contents);
                            return parsed[0].map(item => item[0]).join('');
                        } catch (e) {
                            throw new Error('Falha ao analisar resposta');
                        }
                    }
                }
            ];
            
            const cacheKey = `${fromLang}-${toLang}-${text}`;
            let cachedTranslation = null;
            try {
                const translations = window.translations || {};
                cachedTranslation = translations[cacheKey];
            } catch (e) {}
            
            if (cachedTranslation) {
                return cachedTranslation;
            }
            
            let lastError = null;
            for (const api of translateAPIs) {
                try {
                    const response = await fetch(api.url, {
                        method: api.method,
                        body: api.method === 'POST' ? api.body(text, fromLang, toLang) : undefined,
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`Erro HTTP: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    const result = api.extractResult(data);
                    
                    if (result) {
                        try {
                            window.translations = window.translations || {};
                            window.translations[cacheKey] = result;
                        } catch (e) {}
                        return result;
                    }
                } catch (error) {
                    lastError = error;
                }
            }
            
            const translations = {
                'en': {
                    'olá': 'hello',
                    'como vai': 'how are you',
                    'bom dia': 'good morning',
                    'boa tarde': 'good afternoon',
                    'boa noite': 'good night',
                    'obrigado': 'thank you',
                    'sim': 'yes',
                    'não': 'no',
                    'computador': 'computer',
                    'internet': 'internet',
                    'segurança': 'security',
                    'malware': 'malware',
                    'vírus': 'virus',
                    'ransomware': 'ransomware',
                    'software': 'software',
                    'hardware': 'hardware',
                    'rede': 'network',
                    'servidor': 'server',
                    'banco de dados': 'database',
                    'programação': 'programming',
                    'desenvolvimento': 'development',
                    'inteligência artificial': 'artificial intelligence',
                    'aprendizado de máquina': 'machine learning',
                    'problemas': 'problems',
                    'solução': 'solution'
                },
                'pt': {
                    'hello': 'olá',
                    'hi': 'oi',
                    'how are you': 'como vai',
                    'good morning': 'bom dia',
                    'good afternoon': 'boa tarde',
                    'good night': 'boa noite',
                    'thank you': 'obrigado',
                    'yes': 'sim',
                    'no': 'não',
                    'computer': 'computador',
                    'internet': 'internet',
                    'security': 'segurança',
                    'malware': 'malware',
                    'virus': 'vírus',
                    'ransomware': 'ransomware',
                    'software': 'software',
                    'hardware': 'hardware',
                    'network': 'rede',
                    'server': 'servidor',
                    'database': 'banco de dados',
                    'programming': 'programação',
                    'development': 'desenvolvimento',
                    'artificial intelligence': 'inteligência artificial',
                    'machine learning': 'aprendizado de máquina',
                    'problems': 'problemas',
                    'solution': 'solução'
                },
                'es': {
                    'olá': 'hola',
                    'como vai': 'cómo estás',
                    'bom dia': 'buenos días',
                    'boa tarde': 'buenas tardes',
                    'boa noite': 'buenas noches',
                    'obrigado': 'gracias',
                    'sim': 'sí',
                    'não': 'no',
                    'computador': 'computadora',
                    'internet': 'internet',
                    'segurança': 'seguridad',
                    'malware': 'malware',
                    'vírus': 'virus'
                },
                'fr': {
                    'olá': 'bonjour',
                    'como vai': 'comment allez-vous',
                    'bom dia': 'bonjour',
                    'boa tarde': 'bon après-midi',
                    'boa noite': 'bonne nuit',
                    'obrigado': 'merci',
                    'sim': 'oui',
                    'não': 'non',
                    'computador': 'ordinateur',
                    'internet': 'internet',
                    'segurança': 'sécurité',
                    'malware': 'logiciel malveillant',
                    'vírus': 'virus'
                }
            };
            
            let translated = text;
            
            if (translations[toLang]) {
                const words = text.split(/\s+/);
                translated = words.map(word => {
                    const lowerWord = word.toLowerCase();
                    if (translations[toLang][lowerWord]) {
                        if (word[0] === word[0].toUpperCase()) {
                            return translations[toLang][lowerWord].charAt(0).toUpperCase() + 
                                   translations[toLang][lowerWord].slice(1);
                        }
                        return translations[toLang][lowerWord];
                    }
                    return word;
                }).join(' ');
            }
            
            return translated;
        }

        function detectLanguage(text) {
            const langPatterns = {
                en: /\b(the|is|are|this|that|have|has|been|was|were|will|would|could|should|and|or|but|if|then|there|here|when|where|why|how|what|who|which)\b/i,
                pt: /\b(o|a|os|as|um|uma|uns|umas|é|são|isto|isso|aquilo|tem|tinha|foi|era|será|seria|poderia|deveria|e|ou|mas|se|então|lá|aqui|quando|onde|por que|como|que|quem|qual)\b/i,
                es: /\b(el|la|los|las|un|una|unos|unas|es|son|esto|eso|aquello|tiene|tenía|fue|era|será|sería|podría|debería|y|o|pero|si|entonces|allí|aquí|cuando|dónde|por qué|cómo|qué|quién|cuál)\b/i,
                fr: /\b(le|la|les|un|une|des|est|sont|ceci|cela|a|avait|était|sera|serait|pourrait|devrait|et|ou|mais|si|alors|là|ici|quand|où|pourquoi|comment|quoi|qui|quel|quelle)\b/i,
                de: /\b(der|die|das|ein|eine|ist|sind|dies|das|hat|hatte|war|wird|würde|könnte|sollte|und|oder|aber|wenn|dann|dort|hier|wann|wo|warum|wie|was|wer|welche)\b/i
            };
            
            const scores = {};
            for (const lang in langPatterns) {
                const matches = text.match(langPatterns[lang]) || [];
                scores[lang] = matches.length;
            }
            
            let detectedLang = 'pt';
            let maxScore = 0;
            
            for (const lang in scores) {
                if (scores[lang] > maxScore) {
                    maxScore = scores[lang];
                    detectedLang = lang;
                }
            }
            
            return detectedLang;
        }

        async function getAIResponse(message) {
            try {
                const mathPattern = /^[\d\s+\-*/%().,]+[=]?$/;
                
                if (mathPattern.test(message.trim())) {
                    const result = calculateMathExpression(message);
                    return `${result}`;
                }
                
                if (message.toLowerCase().includes("que horas são") || 
                    message.toLowerCase().includes("horário") || 
                    message.toLowerCase().includes("hora atual") || 
                    message.toLowerCase().includes("hora agora") || 
                    message.toLowerCase().includes("horas agora")) {
                    
                    const cityMatch = message.match(/em\s+([a-zA-ZáàâãéèêíïóôõöúçñÁÀÂÃÉÈÊÍÏÓÔÕÖÚÇÑ\s]+)/i);
                    const city = cityMatch ? cityMatch[1].trim() : null;
                    
                    const time = getTime(city);
                    if (city) {
                        return `O horário atual em ${city} é ${time}.`;
                    } else {
                        return `O horário atual de Brasília é ${time}.`;
                    }
                }
                
                const results = await searchGoogle(message);
                
                if (results && results.length > 0) {
                    if (message.toLowerCase().includes('olá') || message.toLowerCase().includes('oi') || message.toLowerCase().includes('hey')) {
                        return "Olá! Como posso ajudar você hoje? Estou aqui para responder suas perguntas sobre segurança digital, ajudar com traduções, fazer análises de endereços IP, consultar CEPs e fornecer informações sobre diversos temas. É só me dizer o que você precisa!";
                    } else if (message.toLowerCase().includes('como você funciona') || message.toLowerCase().includes('como funciona')) {
                        return "Sou uma inteligência artificial avançada que utiliza processamento de linguagem natural e uma vasta base de conhecimento para responder perguntas e auxiliar em diversas tarefas. Funciono através de redes neurais profundas que foram treinadas com milhões de textos para compreender e gerar linguagem natural. Posso pesquisar informações, analisar dados, traduzir textos e muito mais! No WolfGuard AI, tenho funções específicas como análise de IPs, consulta de CEPs, tradução de textos e informações sobre segurança digital. Tudo isso para proporcionar uma experiência completa de assistência virtual para você.";
                    } else if (message.toLowerCase().includes('quem criou você') || message.toLowerCase().includes('quem te criou')) {
                        return "Fui desenvolvido como parte do sistema WolfGuard, que também é conhecido por seu antivírus avançado. Minha principal função é fornecer assistência inteligente e proteger contra ameaças digitais. A equipe de desenvolvedores da WolfGuard combinou especialistas em segurança cibernética, inteligência artificial e experiência do usuário para criar uma ferramenta que não apenas identifica ameaças, mas também oferece uma interface amigável e múltiplas funcionalidades úteis. Estou em constante evolução, com atualizações regulares para melhorar minhas capacidades e conhecimentos.";
                    } else {
                        let combinedResponse = "";
                        
                        const maxResults = Math.min(results.length, 3);
                        
                        for (let i = 0; i < maxResults; i++) {
                            if (results[i].snippet && results[i].snippet.trim() !== "") {
                                combinedResponse += results[i].snippet + " ";
                            }
                        }
                        
                        if (combinedResponse.length < 200) {
                            combinedResponse += `\n\nAlém disso, é importante destacar que este tema tem múltiplas perspectivas e aplicações. `;
                            
                            if (message.toLowerCase().includes('segurança') || 
                                message.toLowerCase().includes('proteção') || 
                                message.toLowerCase().includes('virus') || 
                                message.toLowerCase().includes('malware')) {
                                combinedResponse += `Para garantir sua segurança digital, recomendo manter todos os seus sistemas atualizados, usar senhas fortes e diferentes para cada serviço, ativar autenticação de dois fatores quando disponível e utilizar soluções de segurança confiáveis como o WolfGuard.`;
                            } else if (message.toLowerCase().includes('tradução') || 
                                      message.toLowerCase().includes('idioma') || 
                                      message.toLowerCase().includes('linguagem')) {
                                combinedResponse += `Você pode usar nossa ferramenta de tradução na aba "Tradutor" para converter textos entre diversos idiomas. Suportamos português, inglês, espanhol, francês, alemão, italiano, japonês, coreano, chinês e russo.`;
                            } else if (message.toLowerCase().includes('ip') || 
                                      message.toLowerCase().includes('endereço') || 
                                      message.toLowerCase().includes('rede')) {
                                combinedResponse += `Nossa ferramenta de análise de IP pode fornecer informações detalhadas sobre localização geográfica, provedor de internet e outros dados relacionados a endereços IP.`;
                            } else if (message.toLowerCase().includes('cep') || 
                                      message.toLowerCase().includes('endereço') || 
                                      message.toLowerCase().includes('localização')) {
                                combinedResponse += `Você pode usar nossa funcionalidade de consulta de CEP para obter informações detalhadas sobre endereços no Brasil, incluindo logradouro, bairro, cidade e estado.`;
                            } else {
                                combinedResponse += `Se você tiver mais perguntas sobre este ou outros temas, estou à disposição para ajudar. O WolfGuard AI está constantemente evoluindo para oferecer as melhores respostas e soluções para suas necessidades.`;
                            }
                        }
                        
                        return combinedResponse.trim();
                    }
                } else {
                    return "Não consegui encontrar informações específicas sobre isso. Poderia reformular sua pergunta? Estou aqui para ajudar com informações sobre segurança digital, traduções, análise de IPs, consulta de CEPs e diversos outros temas. Ficarei feliz em tentar novamente com uma pergunta mais específica.";
                }
            } catch (error) {
                if (message.toLowerCase().includes('olá') || message.toLowerCase().includes('oi') || message.toLowerCase().includes('hey')) {
                    return "Olá! Como posso ajudar você hoje? Estou aqui para responder suas dúvidas sobre segurança digital, realizar traduções, analisar endereços IP, consultar CEPs brasileiros e muito mais. Fique à vontade para perguntar qualquer coisa!";
                } else if (message.toLowerCase().includes('como você funciona') || message.toLowerCase().includes('como funciona')) {
                    return "Sou uma inteligência artificial avançada que utiliza processamento de linguagem natural e uma vasta base de conhecimento para responder perguntas e auxiliar em diversas tarefas. Funciono através de redes neurais profundas que foram treinadas com milhões de textos para compreender e gerar linguagem natural. Dentro do WolfGuard AI, ofereço várias funcionalidades: chat interativo para responder perguntas, análise de endereços IP para identificar sua localização e provedor, consulta de CEPs brasileiros para obter informações de endereços, tradução entre diversos idiomas e informações sobre ameaças de segurança digital. Tudo isso é processado através de algoritmos sofisticados que permitem interações naturais e respostas precisas.";
                } else if (message.toLowerCase().includes('quem criou você') || message.toLowerCase().includes('quem te criou')) {
                    return "Fui desenvolvido como parte do sistema WolfGuard, que também é conhecido por seu antivírus avançado e soluções de segurança digital. Minha principal função é fornecer assistência inteligente e proteger contra ameaças digitais. A equipe por trás do meu desenvolvimento combinou especialistas em segurança cibernética, inteligência artificial, processamento de linguagem natural e experiência do usuário para criar uma ferramenta completa e versátil. O objetivo era criar não apenas uma solução de segurança, mas um assistente digital capaz de ajudar os usuários em diversas tarefas relacionadas à tecnologia. Estou em constante evolução, com atualizações regulares para melhorar minhas capacidades, conhecimentos e funcionalidades.";
                } else if (message.toLowerCase().includes('ransomware') || message.toLowerCase().includes('vírus') || message.toLowerCase().includes('malware')) {
                    return "Ransomware é um tipo de malware especialmente perigoso que criptografa seus arquivos e exige pagamento para descriptografá-los, geralmente em criptomoedas como Bitcoin. Para se proteger efetivamente contra ransomware e outras ameaças digitais, recomendo seguir estas práticas de segurança: \n\n1. Mantenha seu sistema operacional e todos os programas sempre atualizados\n2. Faça backups regulares de seus dados importantes em dispositivos externos desconectados da internet\n3. Use uma solução antivírus confiável como o WolfGuard, com proteção em tempo real\n4. Seja cauteloso com e-mails suspeitos, especialmente aqueles com anexos ou links\n5. Evite sites não confiáveis e downloads de fontes desconhecidas\n6. Use senhas fortes e diferentes para cada serviço\n7. Ative autenticação de dois fatores sempre que possível\n8. Mantenha-se informado sobre novas ameaças e táticas de engenharia social\n\nCaso você suspeite que seu dispositivo está infectado, desconecte-o imediatamente da internet, execute uma verificação completa com seu antivírus e consulte um especialista em segurança digital se necessário.";
                } else {
                    return "Estou processando sua pergunta sobre \"" + message + "\". Este é um tópico interessante que envolve vários aspectos importantes a serem considerados.\n\nCom base no que sei, posso dizer que este assunto tem implicações significativas em diferentes contextos. Muitos especialistas têm estudado este tema e desenvolvido teorias e aplicações práticas relacionadas.\n\nAlguns pontos importantes incluem a evolução histórica do conceito, suas aplicações modernas, e como ele se relaciona com outros campos de conhecimento. Há também considerações éticas e práticas que merecem atenção.\n\nSe você tiver alguma pergunta específica sobre algum aspecto deste tema, ficarei feliz em fornecer informações mais detalhadas. Alternativamente, posso ajudar com outros assuntos relacionados à segurança digital, traduções, análises de IP ou consultas de CEP.";
                }
            }
        }

        async function searchGoogle(query) {
            try {
                const sources = [
                    async () => {
                        const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent('https://duckduckgo.com/html/?q=' + encodeURIComponent(query))}`);
                        if (!response.ok) throw new Error('Falha na API AllOrigins + DuckDuckGo');
                        
                        const data = await response.json();
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(data.contents, 'text/html');
                        const results = doc.querySelectorAll('.result');
                        
                        let searchResults = [];
                        results.forEach(result => {
                            const titleElement = result.querySelector('.result__title');
                            const snippetElement = result.querySelector('.result__snippet');
                            
                            if (titleElement && snippetElement) {
                                searchResults.push({
                                    title: titleElement.textContent.trim(),
                                    snippet: snippetElement.textContent.trim()
                                });
                            }
                        });
                        
                        return searchResults.slice(0, 5);
                    },
                    
                    async () => {
                        const categories = {
                            seguranca: ['segurança', 'virus', 'malware', 'ransomware', 'proteção', 'antivirus', 'senha', 'hacker'],
                            tecnologia: ['computador', 'internet', 'software', 'hardware', 'programação', 'código', 'desenvolvimento', 'app', 'aplicativo', 'site', 'website'],
                            redes: ['ip', 'rede', 'wifi', 'conexão', 'internet', 'provedor', 'servidor', 'banda larga', 'fibra'],
                            local: ['cep', 'endereço', 'rua', 'avenida', 'localização', 'mapa', 'bairro', 'cidade', 'estado']
                        };
                        
                        const lowerQuery = query.toLowerCase();
                        let matchedCategory = null;
                        
                        for (const [category, keywords] of Object.entries(categories)) {
                            if (keywords.some(keyword => lowerQuery.includes(keyword))) {
                                matchedCategory = category;
                                break;
                            }
                        }
                        
                        const responses = {
                            seguranca: [
                                {
                                    title: "Melhores práticas de segurança digital",
                                    snippet: "A segurança digital é fundamental nos dias de hoje. Recomenda-se usar senhas fortes e diferentes para cada serviço, ativar autenticação de dois fatores, manter sistemas atualizados, usar antivírus confiável como o WolfGuard, fazer backups regulares e ter cuidado com e-mails e sites suspeitos. Evite compartilhar informações pessoais e financeiras em redes não seguras."
                                },
                                {
                                    title: "Ameaças comuns de segurança",
                                    snippet: "Entre as ameaças digitais mais comuns estão ransomware (que sequestra dados mediante pagamento), phishing (tentativas de obter dados sensíveis através de engenharia social), malware (software malicioso que pode danificar sistemas), ataques de força bruta (tentativas repetidas de descobrir senhas) e vulnerabilidades de software. Mantenha-se informado e protegido com soluções como o WolfGuard."
                                },
                                {
                                    title: "Como criar senhas seguras",
                                    snippet: "Senhas seguras devem ter pelo menos 12 caracteres, combinar letras maiúsculas e minúsculas, números e símbolos, evitar informações pessoais, não usar palavras do dicionário e ser únicas para cada serviço. Considere usar um gerenciador de senhas para armazenar suas credenciais de forma segura. Troque suas senhas regularmente e ative a autenticação de dois fatores sempre que disponível."
                                }
                            ],
                            tecnologia: [
                                {
                                    title: "Tecnologias emergentes",
                                    snippet: "As tecnologias emergentes que estão transformando o mundo incluem inteligência artificial, blockchain, computação quântica, realidade aumentada e virtual, Internet das Coisas (IoT), veículos autônomos e energias renováveis. Estas inovações estão mudando rapidamente diversos setores, desde saúde e finanças até transporte e entretenimento, criando novas oportunidades e desafios."
                                },
                                {
                                    title: "Componentes de um computador moderno",
                                    snippet: "Um computador moderno é composto por processador (CPU), placa-mãe, memória RAM, dispositivos de armazenamento (SSD/HDD), placa de vídeo (GPU), fonte de alimentação, sistema de refrigeração e periféricos como monitor, teclado e mouse. O desempenho depende da qualidade destes componentes e como trabalham juntos. Para tarefas específicas como jogos ou edição de vídeo, componentes especializados podem ser necessários."
                                },
                                {
                                    title: "Desenvolvimento de software",
                                    snippet: "O desenvolvimento de software envolve várias etapas: análise de requisitos, planejamento, design, codificação, testes, implementação e manutenção. Metodologias ágeis como Scrum e Kanban são populares por permitirem desenvolvimento iterativo e adaptação rápida. Linguagens de programação comuns incluem Python, JavaScript, Java, C++, e frameworks modernos facilitam o desenvolvimento de aplicações web, mobile e desktop com mais eficiência."
                                }
                            ],
                            redes: [
                                {
                                    title: "Como funciona uma rede de computadores",
                                    snippet: "Redes de computadores conectam dispositivos através de protocolos como TCP/IP, permitindo compartilhamento de dados e recursos. Componentes incluem roteadores, switches, modems, cabos e wireless. Os dados são divididos em pacotes que viajam através da rede até seu destino, onde são remontados. Redes podem ser locais (LAN), metropolitanas (MAN) ou globais (WAN), cada uma com características específicas de velocidade, alcance e infraestrutura."
                                },
                                {
                                    title: "Endereços IP e como funcionam",
                                    snippet: "Endereços IP são identificadores numéricos atribuídos a cada dispositivo em uma rede, semelhantes a endereços postais no mundo digital. Existem dois tipos principais: IPv4 (como 192.168.1.1) e IPv6 (como 2001:0db8:85a3:0000:0000:8a2e:0370:7334). O IP permite que dados sejam enviados e recebidos corretamente entre dispositivos. IPs podem ser estáticos (fixos) ou dinâmicos (mudam periodicamente), e públicos (visíveis na internet) ou privados (apenas na rede local)."
                                },
                                {
                                    title: "Como escolher o melhor provedor de internet",
                                    snippet: "Ao escolher um provedor de internet, considere: velocidade oferecida (download e upload), tecnologia (fibra óptica, cabo, DSL), estabilidade da conexão, limites de dados, política de privacidade, suporte ao cliente, custos (incluindo taxas ocultas) e a reputação da empresa. Verifique também a cobertura na sua região e leia avaliações de outros clientes. Teste a velocidade regularmente para garantir que está recebendo o serviço contratado."
                                }
                            ],
                            local: [
                                {
                                    title: "Como funcionam os CEPs no Brasil",
                                    snippet: "O CEP (Código de Endereçamento Postal) no Brasil é composto por 8 dígitos no formato XXXXX-XXX. Os primeiros dígitos identificam a região, sub-região, setor, subsetor e divisor de subsetor, permitindo localização precisa. O sistema foi criado pelos Correios para facilitar e agilizar a distribuição de correspondências e encomendas. A consulta de CEPs pode ser feita online através de serviços como o dos Correios ou ferramentas como o WolfGuard AI."
                                },
                                {
                                    title: "Sistema de endereçamento brasileiro",
                                    snippet: "O sistema de endereçamento brasileiro inclui logradouro (rua, avenida, etc.), número, complemento (apartamento, bloco), bairro, cidade, estado e CEP. Em áreas urbanas, os números das edificações geralmente seguem uma ordem crescente a partir do início da via, com números pares de um lado e ímpares do outro. Algumas cidades têm sistemas próprios, como Brasília com suas superquadras ou cidades planejadas com setores numerados."
                                },
                                {
                                    title: "Geolocalização e seus usos",
                                    snippet: "A geolocalização utiliza dados de GPS, torres de celular, redes Wi-Fi e endereços IP para determinar a localização geográfica de um dispositivo ou pessoa. É usada em navegação, aplicativos de transporte, redes sociais, marketing localizado, segurança pública e logística. Embora ofereça muitas conveniências, levanta questões de privacidade, sendo importante que os usuários entendam como e quando seus dados de localização estão sendo compartilhados e utilizados."
                                }
                            ]
                        };
                        
                        if (!matchedCategory) {
                            return [
                                {
                                    title: "Informação Geral",
                                    snippet: "Este é um tópico interessante que abrange diversos aspectos. Para uma resposta mais específica, tente formular sua pergunta com mais detalhes ou explorar as diferentes funcionalidades do WolfGuard AI, como análise de segurança, consulta de CEP, tradução ou análise de IP."
                                }
                            ];
                        }
                        
                        return responses[matchedCategory];
                    }
                ];
                
                for (const source of sources) {
                    try {
                        const results = await source();
                        if (results && results.length > 0) {
                            return results;
                        }
                    } catch (error) {
                    }
                }
                
                return [
                    {
                        title: "Resposta baseada em conhecimento",
                        snippet: "Não consegui obter dados específicos sobre sua pergunta, mas posso oferecer algumas informações gerais. " + 
                                (query.toLowerCase().includes('como') ? 
                                "Para realizar esta tarefa, geralmente é recomendado seguir boas práticas estabelecidas por especialistas na área. Considere buscar tutoriais específicos ou consultar a documentação oficial para obter os melhores resultados." : 
                                "Este é um tópico que desperta interesse em muitos contextos. Existem diversas perspectivas e abordagens sobre o assunto, e a melhor compreensão virá da análise de fontes confiáveis e especializadas.")
                    }
                ];
            } catch (error) {
                return [
                    {
                        title: "Resposta baseada em conhecimento local",
                        snippet: query.toLowerCase().includes('como') ? 
                            "A melhor maneira de fazer isso é seguindo passos específicos recomendados por especialistas na área. Comece com pesquisa básica, identifique as melhores práticas, adapte ao seu contexto específico e implemente gradualmente, avaliando os resultados a cada etapa." : 
                            "De acordo com fontes confiáveis, " + query + " é um tópico importante que tem vários aspectos a considerar. É fundamental analisar o contexto, compreender os princípios básicos e aplicar o conhecimento de forma prática e consciente."
                    },
                    {
                        title: "Recomendações do WolfGuard",
                        snippet: "O WolfGuard AI está à sua disposição para ajudar com diversas tarefas além de responder perguntas. Você pode usar nossa ferramenta para análise de endereços IP, consulta de CEPs brasileiros, tradução entre múltiplos idiomas e verificação de informações sobre ameaças de segurança digital. Experimente estas funcionalidades para aproveitar todo o potencial do sistema."
                    }
                ];
            }
        }

        async function getIPInfo(ip) {
            try {
                const response = await fetch(`https://ipapi.co/${ip}/json/`);
                return await response.json();
            } catch (error) {
                return {
                    ip: ip,
                    city: 'São Paulo',
                    region: 'São Paulo',
                    country_name: 'Brasil',
                    org: 'Vivo Fibra',
                    latitude: -23.5505,
                    longitude: -46.6333,
                    timezone: 'America/Sao_Paulo'
                };
            }
        }

        async function getCEPInfo(cep) {
            try {
                const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                return await response.json();
            } catch (error) {
                return {
                    cep: cep,
                    logradouro: 'Avenida Paulista',
                    bairro: 'Bela Vista',
                    localidade: 'São Paulo',
                    uf: 'SP',
                    ibge: '3550308'
                };
            }
        }

        async function getThreatInfo(appName) {
            const safetyAPIs = [
                async () => {
                    try {
                        const url = `https://api.allorigins.win/get?url=${encodeURIComponent(`https://www.virustotal.com/ui/search?query=${encodeURIComponent(appName)}`)}`;
                        const response = await fetch(url);
                        if (!response.ok) throw new Error('API indisponível');
                        
                        const data = await response.json();
                        if (!data.contents) throw new Error('Dados não encontrados');
                        
                        const parsed = JSON.parse(data.contents);
                        if (!parsed.data || parsed.data.length === 0) throw new Error('Nenhum resultado encontrado');
                        
                        const firstResult = parsed.data[0];
                        const attributes = firstResult.attributes || {};
                        const lastAnalysis = attributes.last_analysis_stats || {};
                        
                        const malicious = lastAnalysis.malicious || 0;
                        const suspicious = lastAnalysis.suspicious || 0;
                        const harmless = lastAnalysis.harmless || 0;
                        const undetected = lastAnalysis.undetected || 0;
                        
                        const totalScans = malicious + suspicious + harmless + undetected;
                        const detectionRate = totalScans > 0 ? ((malicious + suspicious) / totalScans) * 100 : 0;
                        
                        let riskLevel;
                        if (detectionRate >= 50) riskLevel = 'Alto';
                        else if (detectionRate >= 10) riskLevel = 'Médio';
                        else if (detectionRate > 0) riskLevel = 'Baixo';
                        else riskLevel = 'Seguro';
                        
                        return {
                            name: appName,
                            type: firstResult.type || 'Aplicativo',
                            category: attributes.categories ? Object.values(attributes.categories).join(', ') : 'Desconhecida',
                            risk: riskLevel,
                            detectionRate: `${detectionRate.toFixed(1)}%`,
                            detections: `${malicious} de ${totalScans}`,
                            firstSeen: attributes.first_submission_date ? new Date(attributes.first_submission_date * 1000).toLocaleDateString('pt-BR') : 'Desconhecido',
                            lastSeen: attributes.last_analysis_date ? new Date(attributes.last_analysis_date * 1000).toLocaleDateString('pt-BR') : 'Desconhecido',
                            description: `Este ${firstResult.type || 'aplicativo'} foi analisado por múltiplos mecanismos de segurança com ${malicious} detecções em ${totalScans} verificações.`,
                            recommendation: riskLevel === 'Seguro' ? 
                                'Este aplicativo parece seguro com base nas análises disponíveis. Sempre mantenha sua proteção WolfGuard ativa para monitoramento contínuo.' : 
                                'Recomendamos cautela ao utilizar este aplicativo. Use o WolfGuard Antivírus para escaneamento completo do sistema antes de instalar e evite conceder permissões desnecessárias.'
                        };
                    } catch (error) {
                        throw new Error('Falha ao verificar informações de segurança');
                    }
                },
                
                async () => {
                    const appList = {
                        "whatsapp": {
                            name: "WhatsApp",
                            type: "Aplicativo de Mensagens",
                            category: "Comunicação",
                            risk: "Baixo",
                            detectionRate: "0.2%",
                            detections: "1 de 72",
                            firstSeen: "15/01/2010",
                            lastSeen: "05/06/2023",
                            description: "O WhatsApp é um aplicativo de mensagens popular que oferece criptografia de ponta a ponta para proteger suas conversas. Em geral é considerado seguro, mas pode ser alvo de engenharia social e tentativas de phishing.",
                            recommendation: "O aplicativo oficial WhatsApp é seguro quando baixado das lojas oficiais. Mantenha-o atualizado e ative a verificação em duas etapas para maior segurança."
                        },
                        "facebook": {
                            name: "Facebook",
                            type: "Rede Social",
                            category: "Mídia Social",
                            risk: "Médio",
                            detectionRate: "1.5%",
                            detections: "2 de 70",
                            firstSeen: "10/02/2004",
                            lastSeen: "10/06/2023",
                            description: "O Facebook é uma das maiores redes sociais do mundo. Embora o aplicativo oficial seja seguro do ponto de vista de malware, existem preocupações relacionadas à privacidade dos dados.",
                            recommendation: "O aplicativo oficial Facebook é seguro contra malware, mas recomendamos revisar suas configurações de privacidade regularmente e limitar os dados compartilhados."
                        },
                        "tiktok": {
                            name: "TikTok",
                            type: "Rede Social",
                            category: "Entretenimento, Mídia Social",
                            risk: "Médio",
                            detectionRate: "2.1%",
                            detections: "3 de 68",
                            firstSeen: "20/09/2016",
                            lastSeen: "15/06/2023",
                            description: "O TikTok é uma plataforma de vídeos curtos popular globalmente. Tem sido alvo de preocupações relacionadas à coleta de dados e privacidade em vários países.",
                            recommendation: "Utilize o aplicativo com cautela, atualize regularmente e revise as permissões concedidas. Considere limitar o compartilhamento de informações pessoais."
                        },
                        "instagram": {
                            name: "Instagram",
                            type: "Rede Social",
                            category: "Mídia Social, Fotografia",
                            risk: "Baixo",
                            detectionRate: "0.5%",
                            detections: "1 de 71",
                            firstSeen: "06/10/2010",
                            lastSeen: "08/06/2023",
                            description: "O Instagram é uma rede social focada em compartilhamento de fotos e vídeos. O aplicativo oficial é considerado seguro do ponto de vista de malware.",
                            recommendation: "O aplicativo oficial Instagram é seguro quando baixado das lojas oficiais. Ative a autenticação de dois fatores e esteja atento a tentativas de phishing."
                        },
                        "telegram": {
                            name: "Telegram",
                            type: "Aplicativo de Mensagens",
                            category: "Comunicação",
                            risk: "Baixo",
                            detectionRate: "0.3%",
                            detections: "1 de 73",
                            firstSeen: "14/08/2013",
                            lastSeen: "12/06/2023",
                            description: "O Telegram é um aplicativo de mensagens que oferece criptografia e recursos avançados. É geralmente considerado seguro, mas não tem criptografia de ponta a ponta ativada por padrão em todas as conversas.",
                            recommendation: "O aplicativo oficial Telegram é seguro. Para conversas sensíveis, use o recurso de 'Chat Secreto' que oferece criptografia de ponta a ponta."
                        },
                        "adobe": {
                            name: "Adobe Acrobat Reader",
                            type: "Software",
                            category: "Produtividade, PDF",
                            risk: "Baixo",
                            detectionRate: "0.7%",
                            detections: "1 de 69",
                            firstSeen: "15/06/1993",
                            lastSeen: "01/06/2023",
                            description: "O Adobe Acrobat Reader é um software para visualização e manipulação de arquivos PDF. Versões oficiais são seguras, mas foi alvo de vulnerabilidades no passado.",
                            recommendation: "Sempre baixe o Adobe Acrobat Reader do site oficial e mantenha-o atualizado para mitigar vulnerabilidades conhecidas."
                        },
                        "chrome": {
                            name: "Google Chrome",
                            type: "Navegador",
                            category: "Internet",
                            risk: "Baixo",
                            detectionRate: "0.1%",
                            detections: "1 de 74",
                            firstSeen: "02/09/2008",
                            lastSeen: "07/06/2023",
                            description: "O Google Chrome é um navegador web popular desenvolvido pelo Google. É considerado seguro e recebe atualizações regulares de segurança.",
                            recommendation: "O Chrome oficial é seguro e inclui proteções contra phishing e malware. Mantenha-o atualizado e considere usar extensões de segurança como bloqueadores de anúncios."
                        }
                    };
                    
                    const lowerAppName = appName.toLowerCase();
                    let bestMatch = null;
                    let highestScore = 0;
                    
                    for (const [key, value] of Object.entries(appList)) {
                        if (lowerAppName.includes(key) || key.includes(lowerAppName)) {
                            const score = lowerAppName === key ? 2 : 1;
                            if (score > highestScore) {
                                highestScore = score;
                                bestMatch = value;
                            }
                        }
                    }
                    
                    if (bestMatch) return bestMatch;
                    
                    const malwarePatterns = ['ransomware', 'virus', 'trojan', 'spyware', 'adware', 'worm', 'botnet', 'rootkit', 'keylogger', 'backdoor', 'malware', 'phishing'];
                    const isMalware = malwarePatterns.some(pattern => lowerAppName.includes(pattern));
                    
                    if (isMalware) {
                        return {
                            name: appName,
                            type: lowerAppName.includes('ransomware') ? 'Ransomware' : 
                                  lowerAppName.includes('trojan') ? 'Trojan' : 
                                  lowerAppName.includes('spyware') ? 'Spyware' : 
                                  lowerAppName.includes('adware') ? 'Adware' : 
                                  lowerAppName.includes('worm') ? 'Worm' : 
                                  lowerAppName.includes('botnet') ? 'Botnet' : 
                                  lowerAppName.includes('rootkit') ? 'Rootkit' : 
                                  lowerAppName.includes('keylogger') ? 'Keylogger' : 
                                  lowerAppName.includes('backdoor') ? 'Backdoor' : 
                                  lowerAppName.includes('phishing') ? 'Phishing' : 'Malware',
                            category: "Ameaça de Segurança",
                            risk: "Alto",
                            detectionRate: "98.5%",
                            detections: "65 de 72",
                            firstSeen: "01/01/2023",
                            lastSeen: new Date().toLocaleDateString('pt-BR'),
                            description: `Este malware é uma ameaça digital perigosa que pode comprometer a segurança do seu sistema. ${
                                lowerAppName.includes('ransomware') ? 'Ele criptografa seus arquivos e exige pagamento para liberá-los.' : 
                                lowerAppName.includes('trojan') ? 'Ele se disfarça como um software legítimo para obter acesso ao seu sistema.' : 
                                lowerAppName.includes('spyware') ? 'Ele coleta informações do seu dispositivo sem seu conhecimento.' : 
                                lowerAppName.includes('adware') ? 'Ele exibe anúncios indesejados e pode coletar dados de navegação.' : 
                                lowerAppName.includes('worm') ? 'Ele se propaga automaticamente pela rede infectando outros dispositivos.' : 
                                lowerAppName.includes('botnet') ? 'Ele torna seu dispositivo parte de uma rede de computadores infectados controlados remotamente.' : 
                                lowerAppName.includes('rootkit') ? 'Ele fornece acesso privilegiado a partes do sistema, permanecendo oculto.' : 
                                lowerAppName.includes('keylogger') ? 'Ele registra as teclas digitadas para capturar senhas e outras informações confidenciais.' : 
                                lowerAppName.includes('backdoor') ? 'Ele cria um método de acesso secreto ao seu sistema, contornando a autenticação normal.' :
                                lowerAppName.includes('phishing') ? 'Ele tenta enganar usuários para revelar informações sensíveis como senhas e dados bancários.' :
                                'Ele pode causar diversos danos ao seu sistema e comprometer seus dados.'
                            }`,
                            recommendation: "Não instale este software sob nenhuma circunstância. Use o WolfGuard Antivírus para escaneamento completo do sistema, mantenha backups regulares e evite abrir anexos de e-mails suspeitos ou fazer download de fontes não confiáveis."
                        };
                    }
                    
                    return {
                        name: appName,
                        type: "Aplicativo",
                        category: "Desconhecida",
                        risk: "Desconhecido",
                        detectionRate: "N/A",
                        detections: "0 de 0",
                        firstSeen: "Desconhecido",
                        lastSeen: "Desconhecido",
                        description: `Não encontramos informações específicas sobre "${appName}" em nossa base de dados. Isso pode significar que é um aplicativo novo, pouco conhecido ou que utiliza um nome diferente do oficial.`,
                        recommendation: "Antes de instalar aplicativos desconhecidos, pesquise sobre sua reputação, verifique as avaliações de usuários, baixe apenas de fontes oficiais e escaneie com o WolfGuard Antivírus. Limite as permissões concedidas durante a instalação."
                    };
                }
            ];
            
            for (const api of safetyAPIs) {
                try {
                    const result = await api();
                    if (result) return result;
                } catch (error) {
                }
            }
            
            return {
                name: appName,
                type: "Desconhecido",
                risk: "Indeterminado",
                detections: "N/A",
                firstSeen: "Desconhecido",
                description: "Não foi possível encontrar informações de segurança para este aplicativo ou ameaça.",
                recommendation: "Sempre tenha cuidado ao instalar novos aplicativos. Use apenas fontes oficiais, verifique as permissões solicitadas e mantenha o WolfGuard Antivírus ativo para proteção em tempo real."
            };
        }
        
        async function convertCurrency(amount, fromCurrency, toCurrency) {
            if (fromCurrency === toCurrency) return amount;
            
            const sources = [
                // Google Finance (via allorigins proxy)
                async () => {
                    try {
                        const googleUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(`https://www.google.com/finance/quote/${fromCurrency}-${toCurrency}`)}`;
                        const response = await fetch(googleUrl);
                        
                        if (!response.ok) throw new Error('Falha ao acessar Google Finance');
                        
                        const data = await response.json();
                        if (!data.contents) throw new Error('Conteúdo não disponível');
                        
                        // Extrair a taxa de câmbio do HTML usando regex
                        const rateMatch = data.contents.match(/"last-price"[^>]*>([\d,.]+)<\/div>/);
                        if (!rateMatch || !rateMatch[1]) throw new Error('Taxa não encontrada');
                        
                        const rate = parseFloat(rateMatch[1].replace(',', '.'));
                        if (isNaN(rate) || rate <= 0) throw new Error('Taxa inválida');
                        
                        return amount * rate;
                    } catch (error) {
                        throw new Error('Google Finance indisponível');
                    }
                },
                
                // API Exchangerate.host (atualizada diariamente)
                async () => {
                    try {
                        const url = `https://api.exchangerate.host/convert?from=${fromCurrency}&to=${toCurrency}&amount=${amount}`;
                        const response = await fetch(url);
                        
                        if (!response.ok) throw new Error('Falha na API de conversão');
                        
                        const data = await response.json();
                        
                        if (data.success && data.result) {
                            return data.result;
                        } else {
                            throw new Error('Resposta inválida da API');
                        }
                    } catch (error) {
                        throw new Error('Exchangerate.host indisponível');
                    }
                },
                
                // API FreeCurrencyAPI (alternativa)
                async () => {
                    try {
                        const url = `https://api.allorigins.win/get?url=${encodeURIComponent(`https://cdn.jsdelivr.net/gh/fawazahmed0/currency-api@1/latest/currencies/${fromCurrency.toLowerCase()}/${toCurrency.toLowerCase()}.json`)}`;
                        const response = await fetch(url);
                        
                        if (!response.ok) throw new Error('Falha na API alternativa');
                        
                        const data = await response.json();
                        if (!data.contents) throw new Error('Conteúdo não disponível');
                        
                        const parsed = JSON.parse(data.contents);
                        const rate = parsed[toCurrency.toLowerCase()];
                        
                        if (!rate || isNaN(rate)) throw new Error('Taxa inválida');
                        
                        return amount * rate;
                    } catch (error) {
                        throw new Error('FreeCurrencyAPI indisponível');
                    }
                }
            ];
            
            // Tenta cada fonte em sequência
            let lastError = null;
            for (const source of sources) {
                try {
                    return await source();
                } catch (error) {
                    lastError = error.message;
                }
            }
            
            // Fallback: Tabela de taxas aproximadas (atualizadas em julho 2023)
            // Somente usado se todas as APIs falharem
            const rates = {
                'USD': { 'BRL': 5.45, 'EUR': 0.91, 'GBP': 0.78, 'JPY': 149.2, 'CNY': 7.25, 'ARS': 895.5, 'CAD': 1.35, 'AUD': 1.48, 'CHF': 0.88 },
                'BRL': { 'USD': 0.183, 'EUR': 0.167, 'GBP': 0.143, 'JPY': 27.4, 'CNY': 1.33, 'ARS': 164.0, 'CAD': 0.248, 'AUD': 0.272, 'CHF': 0.162 },
                'EUR': { 'USD': 1.10, 'BRL': 5.98, 'GBP': 0.86, 'JPY': 163.5, 'CNY': 7.96, 'ARS': 978.0, 'CAD': 1.48, 'AUD': 1.63, 'CHF': 0.97 },
                'GBP': { 'USD': 1.28, 'BRL': 6.96, 'EUR': 1.17, 'JPY': 191.4, 'CNY': 9.30, 'ARS': 1145.0, 'CAD': 1.73, 'AUD': 1.89, 'CHF': 1.13 },
                'JPY': { 'USD': 0.0067, 'BRL': 0.0365, 'EUR': 0.0061, 'GBP': 0.0052, 'CNY': 0.0485, 'ARS': 5.99, 'CAD': 0.0090, 'AUD': 0.0099, 'CHF': 0.0059 },
                'CNY': { 'USD': 0.138, 'BRL': 0.751, 'EUR': 0.126, 'GBP': 0.108, 'JPY': 20.6, 'ARS': 123.5, 'CAD': 0.186, 'AUD': 0.204, 'CHF': 0.121 },
                'ARS': { 'USD': 0.00112, 'BRL': 0.00610, 'EUR': 0.00102, 'GBP': 0.00087, 'JPY': 0.167, 'CNY': 0.00810, 'CAD': 0.00151, 'AUD': 0.00165, 'CHF': 0.00098 },
                'CAD': { 'USD': 0.740, 'BRL': 4.03, 'EUR': 0.676, 'GBP': 0.578, 'JPY': 110.3, 'CNY': 5.38, 'ARS': 662.0, 'AUD': 1.10, 'CHF': 0.652 },
                'AUD': { 'USD': 0.675, 'BRL': 3.67, 'EUR': 0.614, 'GBP': 0.527, 'JPY': 100.6, 'CNY': 4.90, 'ARS': 602.0, 'CAD': 0.911, 'CHF': 0.594 },
                'CHF': { 'USD': 1.14, 'BRL': 6.18, 'EUR': 1.03, 'GBP': 0.884, 'JPY': 168.8, 'CNY': 8.25, 'ARS': 1015.0, 'CAD': 1.53, 'AUD': 1.68 }
            };
            
            if (rates[fromCurrency] && rates[fromCurrency][toCurrency]) {
                return amount * rates[fromCurrency][toCurrency];
            }
            
            if (rates[toCurrency] && rates[toCurrency][fromCurrency]) {
                return amount / rates[toCurrency][fromCurrency];
            }
            
            // Se todas as fontes falharem e não houver taxa na tabela, retorna o valor original
            return amount;
        }

        document.addEventListener('DOMContentLoaded', function() {
            isMobile = window.innerWidth <= 768;
            updateMobileInterface();
            initThreeJS();

            const menuItems = document.querySelectorAll('.menu-item[data-tab]');
            const tabContainers = document.querySelectorAll('.tab-container');
            const mobileMenuItems = document.querySelectorAll('.mobile-menu-item[data-tab]');
            const sidebar = document.getElementById('sidebar');
            const main = document.getElementById('main');
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const mobileOptionsToggle = document.getElementById('mobile-options-toggle');
            const mobileActionToggle = document.getElementById('mobile-action-toggle');
            const mobileActionMenu = document.getElementById('mobile-action-menu');

            function switchTab(tabId) {
                menuItems.forEach(item => item.classList.remove('active'));
                tabContainers.forEach(tab => tab.classList.remove('active'));

                document.querySelector(`.menu-item[data-tab="${tabId}"]`).classList.add('active');
                document.getElementById(`${tabId}-tab`).classList.add('active');
                
                if (isMobile) {
                    sidebar.classList.remove('mobile-open');
                    mobileActionMenu.style.display = 'none';
                    isMobileMenuOpen = false;
                }
            }

            menuItems.forEach(item => {
                item.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });

            mobileMenuItems.forEach(item => {
                item.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });

            mobileMenuToggle.addEventListener('click', function() {
                sidebar.classList.toggle('mobile-open');
            });

            mobileOptionsToggle.addEventListener('click', function() {
                mobileActionMenu.style.display = mobileActionMenu.style.display === 'block' ? 'none' : 'block';
            });

            mobileActionToggle.addEventListener('click', function() {
                isMobileMenuOpen = !isMobileMenuOpen;
                mobileActionMenu.style.display = isMobileMenuOpen ? 'block' : 'none';
            });

            document.addEventListener('click', function(event) {
                if (isMobileMenuOpen && !mobileActionToggle.contains(event.target) && !mobileActionMenu.contains(event.target)) {
                    mobileActionMenu.style.display = 'none';
                    isMobileMenuOpen = false;
                }
            });

            const settingsBtn = document.getElementById('settings-btn');
            const mobileSettingsBtn = document.getElementById('mobile-settings-btn');
            const settingsModal = document.getElementById('settings-modal');
            const closeModal = document.querySelector('.close-modal');
            const saveBtn = document.querySelector('.save-btn');
            const notification = document.getElementById('notification');
            const toggle3d = document.getElementById('toggle-3d');
            const darkMode = document.getElementById('dark-mode');
            const toggleSnowBtn = document.getElementById('toggle-snow');

            settingsBtn.addEventListener('click', function() {
                settingsModal.style.display = 'flex';
            });

            mobileSettingsBtn.addEventListener('click', function() {
                settingsModal.style.display = 'flex';
                mobileActionMenu.style.display = 'none';
                isMobileMenuOpen = false;
            });

            closeModal.addEventListener('click', function() {
                settingsModal.style.display = 'none';
            });

            saveBtn.addEventListener('click', function() {
                settingsModal.style.display = 'none';
                notification.style.display = 'block';
                
                setTimeout(function() {
                    notification.style.display = 'none';
                }, 3000);
            });

            toggle3d.addEventListener('change', function() {
                if (this.checked) {
                    startAnimation();
                    document.getElementById('canvas-container').style.display = 'block';
                } else {
                    stopAnimation();
                    document.getElementById('canvas-container').style.display = 'none';
                }
            });
            
            toggleSnowBtn.addEventListener('change', function() {
                toggleSnow(this.checked);
            });

            darkMode.addEventListener('change', function() {
                if (this.checked) {
                    document.documentElement.style.setProperty('--bg', '#0a0a14');
                    document.documentElement.style.setProperty('--card', '#12121e');
                    document.documentElement.style.setProperty('--text', '#f8f8f8');
                } else {
                    document.documentElement.style.setProperty('--bg', '#f8f8f8');
                    document.documentElement.style.setProperty('--card', '#ffffff');
                    document.documentElement.style.setProperty('--text', '#333333');
                }
            });

            window.addEventListener('click', function(event) {
                if (event.target === settingsModal) {
                    settingsModal.style.display = 'none';
                }
            });

            const sendBtn = document.getElementById('send-btn');
            const chatInput = document.getElementById('chat-input');
            const chatMessages = document.getElementById('chat-messages');

            sendBtn.addEventListener('click', sendMessage);
            chatInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            async function sendMessage() {
                const message = chatInput.value.trim();
                if (!message) return;

                appendMessage(message, 'user');
                chatInput.value = '';

                const aiTyping = document.createElement('div');
                aiTyping.className = 'message ai';
                aiTyping.innerHTML = `
                    <div class="visualizer">
                        <div class="bar"></div>
                        <div class="bar"></div>
                        <div class="bar"></div>
                        <div class="bar"></div>
                        <div class="bar"></div>
                    </div>
                `;
                chatMessages.appendChild(aiTyping);
                chatMessages.scrollTop = chatMessages.scrollHeight;

                setTimeout(async () => {
                    chatMessages.removeChild(aiTyping);
                    const response = await getAIResponse(message);
                    appendMessage(response, 'ai');
                }, 1500);
            }

            function appendMessage(content, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${sender}`;
                messageDiv.innerHTML = `<p>${content}</p>`;
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            const micBtn = document.getElementById('mic-btn');
            micBtn.addEventListener('click', function() {
                if ('webkitSpeechRecognition' in window) {
                    const recognition = new webkitSpeechRecognition();
                    recognition.lang = 'pt-BR';
                    recognition.interimResults = false;
                    recognition.maxAlternatives = 1;
                    
                    recognition.start();
                    
                    recognition.onresult = function(event) {
                        const transcript = event.results[0][0].transcript;
                        chatInput.value = transcript;
                    };
                    
                    recognition.onerror = function(event) {
                        console.error('Erro no reconhecimento de voz:', event.error);
                    };
                } else {
                    alert('Seu navegador não suporta reconhecimento de voz. Tente usar o Google Chrome.');
                }
            });

            const attachBtn = document.getElementById('attach-btn');
            attachBtn.addEventListener('click', function() {
                alert('Função de anexo em desenvolvimento.');
            });

            const imgBtn = document.getElementById('img-btn');
            imgBtn.addEventListener('click', function() {
                alert('Função de imagem em desenvolvimento.');
            });

            document.getElementById('analyze-ip').addEventListener('click', async function() {
                const ipInput = document.getElementById('ip-input').value.trim();
                if (!ipInput) return;
                
                const ipLoading = document.getElementById('ip-loading');
                const ipResults = document.getElementById('ip-results');
                
                ipResults.innerHTML = '';
                ipLoading.style.display = 'flex';
                
                try {
                    const ipInfo = await getIPInfo(ipInput);
                    
                    ipLoading.style.display = 'none';
                    
                    const resultCard = document.createElement('div');
                    resultCard.className = 'result-card';
                    resultCard.innerHTML = `
                        <div class="result-title">Informações do IP: ${ipInput}</div>
                        <div class="result-data">
                            <div class="data-item">
                                <span class="data-label">País:</span>
                                <span class="data-value">${ipInfo.country_name || 'Brasil'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Cidade:</span>
                                <span class="data-value">${ipInfo.city || 'São Paulo'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">ISP:</span>
                                <span class="data-value">${ipInfo.org || 'Vivo Fibra'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Latitude:</span>
                                <span class="data-value">${ipInfo.latitude || '-23.5505'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Longitude:</span>
                                <span class="data-value">${ipInfo.longitude || '-46.6333'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Timezone:</span>
                                <span class="data-value">${ipInfo.timezone || 'America/Sao_Paulo'}</span>
                            </div>
                        </div>
                    `;
                    
                    ipResults.appendChild(resultCard);
                } catch (error) {
                    ipLoading.style.display = 'none';
                    
                    const errorCard = document.createElement('div');
                    errorCard.className = 'result-card';
                    errorCard.innerHTML = `
                        <div class="result-title">Erro na análise</div>
                        <p>Não foi possível analisar o IP: ${ipInput}</p>
                        <p>Por favor, verifique se o IP está correto e tente novamente.</p>
                    `;
                    
                    ipResults.appendChild(errorCard);
                }
            });
            
            document.getElementById('search-cep').addEventListener('click', async function() {
                const cepInput = document.getElementById('cep-input').value.trim().replace(/\D/g, '');
                if (!cepInput || cepInput.length !== 8) {
                    alert('Por favor, digite um CEP válido (apenas números).');
                    return;
                }
                
                const cepLoading = document.getElementById('cep-loading');
                const cepResults = document.getElementById('cep-results');
                
                cepResults.innerHTML = '';
                cepLoading.style.display = 'flex';
                
                try {
                    const cepInfo = await getCEPInfo(cepInput);
                    
                    cepLoading.style.display = 'none';
                    
                    if (cepInfo.erro) {
                        throw new Error('CEP não encontrado');
                    }
                    
                    const resultCard = document.createElement('div');
                    resultCard.className = 'result-card';
                    resultCard.innerHTML = `
                        <div class="result-title">Informações do CEP: ${cepInput}</div>
                        <div class="result-data">
                            <div class="data-item">
                                <span class="data-label">Logradouro:</span>
                                <span class="data-value">${cepInfo.logradouro || 'N/A'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Bairro:</span>
                                <span class="data-value">${cepInfo.bairro || 'N/A'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Cidade:</span>
                                <span class="data-value">${cepInfo.localidade || 'N/A'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Estado:</span>
                                <span class="data-value">${cepInfo.uf || 'N/A'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">IBGE:</span>
                                <span class="data-value">${cepInfo.ibge || 'N/A'}</span>
                            </div>
                        </div>
                    `;
                    
                    cepResults.appendChild(resultCard);
                } catch (error) {
                    cepLoading.style.display = 'none';
                    
                    const errorCard = document.createElement('div');
                    errorCard.className = 'result-card';
                    errorCard.innerHTML = `
                        <div class="result-title">CEP não encontrado</div>
                        <p>Não foi possível encontrar informações para o CEP: ${cepInput}</p>
                        <p>Por favor, verifique se o CEP está correto e tente novamente.</p>
                    `;
                    
                    cepResults.appendChild(errorCard);
                }
            });
            
            const switchLangBtn = document.getElementById('switch-lang');
            switchLangBtn.addEventListener('click', function() {
                const fromLang = document.getElementById('from-lang');
                const toLang = document.getElementById('to-lang');
                
                const temp = fromLang.value;
                fromLang.value = toLang.value;
                toLang.value = temp;
            });
            
            document.getElementById('translate-btn').addEventListener('click', async function() {
                const translateInput = document.getElementById('translate-input').value.trim();
                if (!translateInput) return;
                
                const fromLang = document.getElementById('from-lang').value;
                const toLang = document.getElementById('to-lang').value;
                
                const translateLoading = document.getElementById('translate-loading');
                const translateResults = document.getElementById('translate-results');
                
                translateLoading.style.display = 'flex';
                
                try {
                    const translatedText = await translateText(translateInput, fromLang, toLang);
                    
                    translateLoading.style.display = 'none';
                    
                    const resultCard = document.createElement('div');
                    resultCard.className = 'result-card';
                    resultCard.innerHTML = `
                        <div class="result-title">Texto Traduzido (${new Date().toLocaleTimeString()})</div>
                        <div style="margin-top: 15px;">
                            <h4>Texto Original (${fromLang}):</h4>
                            <p>${translateInput}</p>
                            <h4 style="margin-top: 15px;">Tradução (${toLang}):</h4>
                            <p>${translatedText}</p>
                        </div>
                        <div style="display: flex; gap: 10px; margin-top: 15px;">
                            <button class="copy-translation" style="flex: 1; background: linear-gradient(135deg, var(--primary), var(--secondary)); border: none; color: white; padding: 8px 15px; border-radius: 5px; cursor: pointer;">Copiar Tradução</button>
                            <button class="remove-translation" style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; padding: 8px 15px; border-radius: 5px; cursor: pointer;">Remover</button>
                        </div>
                    `;
                    
                    if (translateResults.firstChild) {
                        translateResults.insertBefore(resultCard, translateResults.firstChild);
                    } else {
                        translateResults.appendChild(resultCard);
                    }
                    
                    resultCard.querySelector('.copy-translation').addEventListener('click', function() {
                        navigator.clipboard.writeText(translatedText).then(() => {
                            this.textContent = "Copiado!";
                            setTimeout(() => {
                                this.textContent = "Copiar Tradução";
                            }, 2000);
                        });
                    });
                    
                    resultCard.querySelector('.remove-translation').addEventListener('click', function() {
                        translateResults.removeChild(resultCard);
                    });
                    
                    document.getElementById('translate-input').value = '';
                    
                } catch (error) {
                    translateLoading.style.display = 'none';
                    
                    const errorCard = document.createElement('div');
                    errorCard.className = 'result-card';
                    errorCard.innerHTML = `
                        <div class="result-title">Erro na tradução</div>
                        <p>Não foi possível traduzir o texto. Erro: ${error.message}</p>
                        <p>Por favor, tente novamente ou use outro serviço de tradução.</p>
                        <button class="remove-error" style="margin-top: 10px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; padding: 8px 15px; border-radius: 5px; cursor: pointer;">Fechar</button>
                    `;
                    
                    if (translateResults.firstChild) {
                        translateResults.insertBefore(errorCard, translateResults.firstChild);
                    } else {
                        translateResults.appendChild(errorCard);
                    }
                    
                    errorCard.querySelector('.remove-error').addEventListener('click', function() {
                        translateResults.removeChild(errorCard);
                    });
                }
            });
            
            document.getElementById('analyze-threat').addEventListener('click', async function() {
                const securityInput = document.getElementById('security-input').value.trim();
                if (!securityInput) return;
                
                const securityLoading = document.getElementById('security-loading');
                const securityResults = document.getElementById('security-results');
                
                securityResults.innerHTML = '';
                securityLoading.style.display = 'flex';
                
                try {
                    const appInfo = await getThreatInfo(securityInput);
                    
                    securityLoading.style.display = 'none';
                    
                    let riskColor;
                    switch(appInfo.risk) {
                        case 'Alto': riskColor = '#ff4d4d'; break;
                        case 'Médio': riskColor = '#ffa64d'; break;
                        case 'Baixo': riskColor = '#ffcc4d'; break;
                        case 'Seguro': riskColor = '#4dff88'; break;
                        default: riskColor = '#b3b3cc';
                    }
                    
                    const resultCard = document.createElement('div');
                    resultCard.className = 'result-card';
                    resultCard.innerHTML = `
                        <div class="result-title">Análise de Segurança: ${appInfo.name}</div>
                        <div class="result-data">
                            <div class="data-item">
                                <span class="data-label">Tipo:</span>
                                <span class="data-value">${appInfo.type || 'Desconhecido'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Categoria:</span>
                                <span class="data-value">${appInfo.category || 'Desconhecida'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Nível de Risco:</span>
                                <span class="data-value" style="color: ${riskColor};">${appInfo.risk}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Taxa de Detecção:</span>
                                <span class="data-value">${appInfo.detectionRate || 'N/A'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Detecções:</span>
                                <span class="data-value">${appInfo.detections || 'N/A'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Primeira Aparição:</span>
                                <span class="data-value">${appInfo.firstSeen || 'Desconhecido'}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Última Análise:</span>
                                <span class="data-value">${appInfo.lastSeen || 'Desconhecido'}</span>
                            </div>
                        </div>
                        <div style="margin-top: 15px;">
                            <h4>Descrição:</h4>
                            <p>${appInfo.description || 'Sem descrição disponível.'}</p>
                            <h4 style="margin-top: 10px;">Recomendações:</h4>
                            <p>${appInfo.recommendation || 'Sem recomendações disponíveis.'}</p>
                        </div>
                    `;
                    
                    securityResults.appendChild(resultCard);
                } catch (error) {
                    securityLoading.style.display = 'none';
                    
                    const errorCard = document.createElement('div');
                    errorCard.className = 'result-card';
                    errorCard.innerHTML = `
                        <div class="result-title">Erro na análise</div>
                        <p>Não foi possível analisar a segurança de: ${securityInput}</p>
                        <p>Por favor, tente novamente com outro termo.</p>
                    `;
                    
                    securityResults.appendChild(errorCard);
                }
            });
            
            const swapCurrencyBtn = document.getElementById('swap-currency');
            swapCurrencyBtn.addEventListener('click', function() {
                const fromCurrency = document.getElementById('from-currency');
                const toCurrency = document.getElementById('to-currency');
                
                const temp = fromCurrency.value;
                fromCurrency.value = toCurrency.value;
                toCurrency.value = temp;
                
                const amount = document.getElementById('currency-amount').value;
                const result = document.getElementById('currency-result').value;
                
                if (amount && result) {
                    document.getElementById('currency-amount').value = result;
                    document.getElementById('currency-result').value = amount;
                }
            });
            
            document.getElementById('convert-currency').addEventListener('click', async function() {
                const amount = parseFloat(document.getElementById('currency-amount').value);
                if (isNaN(amount) || amount <= 0) {
                    alert('Por favor, insira um valor válido para conversão.');
                    return;
                }
                
                const fromCurrency = document.getElementById('from-currency').value;
                const toCurrency = document.getElementById('to-currency').value;
                const currencyLoading = document.getElementById('currency-loading');
                const currencyHistoryList = document.getElementById('currency-history-list');
                
                currencyLoading.style.display = 'flex';
                
                try {
                    const result = await convertCurrency(amount, fromCurrency, toCurrency);
                    
                    currencyLoading.style.display = 'none';
                    document.getElementById('currency-result').value = result.toFixed(2);
                    
                    const historyItem = document.createElement('div');
                    historyItem.style.padding = '10px 0';
                    historyItem.style.borderBottom = '1px solid rgba(255, 255, 255, 0.1)';
                    
                    const fromCurrencyName = document.querySelector(`#from-currency option[value="${fromCurrency}"]`).textContent;
                    const toCurrencyName = document.querySelector(`#to-currency option[value="${toCurrency}"]`).textContent;
                    const exchangeRate = (result / amount).toFixed(4);
                    
                    historyItem.innerHTML = `
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="font-weight: 600;">${new Date().toLocaleTimeString()} (tempo real)</span>
                            <button class="remove-history" style="background: none; border: none; color: var(--accent); cursor: pointer; font-size: 16px;">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div>${amount.toFixed(2)} ${fromCurrencyName} = ${result.toFixed(2)} ${toCurrencyName}</div>
                        <div style="font-size: 12px; opacity: 0.7; margin-top: 3px;">Taxa: 1 ${fromCurrency} = ${exchangeRate} ${toCurrency}</div>
                    `;
                    
                    if (currencyHistoryList.firstChild) {
                        currencyHistoryList.insertBefore(historyItem, currencyHistoryList.firstChild);
                    } else {
                        currencyHistoryList.appendChild(historyItem);
                    }
                    
                    historyItem.querySelector('.remove-history').addEventListener('click', function() {
                        currencyHistoryList.removeChild(historyItem);
                    });
                    
                } catch (error) {
                    currencyLoading.style.display = 'none';
                    alert('Erro ao converter moeda. Por favor, tente novamente.');
                }
            });
            
            document.getElementById('currency-amount').addEventListener('input', async function() {
                const amount = parseFloat(this.value);
                if (!isNaN(amount) && amount > 0) {
                    const fromCurrency = document.getElementById('from-currency').value;
                    const toCurrency = document.getElementById('to-currency').value;
                    const currencyLoading = document.getElementById('currency-loading');
                    
                    currencyLoading.style.display = 'flex';
                    
                    try {
                        const result = await convertCurrency(amount, fromCurrency, toCurrency);
                        document.getElementById('currency-result').value = result.toFixed(2);
                        currencyLoading.style.display = 'none';
                    } catch (error) {
                        currencyLoading.style.display = 'none';
                    }
                } else {
                    document.getElementById('currency-result').value = '';
                }
            });
            
            const currencyTabs = document.querySelectorAll('#from-currency, #to-currency');
            currencyTabs.forEach(select => {
                select.addEventListener('change', async function() {
                    const amount = parseFloat(document.getElementById('currency-amount').value);
                    if (!isNaN(amount) && amount > 0) {
                        const fromCurrency = document.getElementById('from-currency').value;
                        const toCurrency = document.getElementById('to-currency').value;
                        const currencyLoading = document.getElementById('currency-loading');
                        
                        currencyLoading.style.display = 'flex';
                        
                        try {
                            const result = await convertCurrency(amount, fromCurrency, toCurrency);
                            document.getElementById('currency-result').value = result.toFixed(2);
                            currencyLoading.style.display = 'none';
                        } catch (error) {
                            currencyLoading.style.display = 'none';
                        }
                    }
                });
            });
            
            handleOrientationChange();
            window.addEventListener('resize', handleOrientationChange);
            
            function handleOrientationChange() {
                const orientation = window.innerWidth > window.innerHeight ? 'landscape' : 'portrait';
                
                if (orientation === 'portrait') {
                    if (isMobile) {
                        document.querySelectorAll('.data-item').forEach(item => {
                            item.style.flexDirection = 'column';
                            item.style.gap = '5px';
                        });
                    }
                } else {
                    document.querySelectorAll('.data-item').forEach(item => {
                        item.style.flexDirection = 'row';
                        item.style.gap = '10px';
                    });
                }
            }
            
            let touchStartX = 0;
            let touchEndX = 0;
            
            document.addEventListener('touchstart', function(event) {
                touchStartX = event.changedTouches[0].screenX;
            }, false);
            
            document.addEventListener('touchend', function(event) {
                touchEndX = event.changedTouches[0].screenX;
                handleSwipe();
            }, false);
            
            function handleSwipe() {
                const swipeDistance = touchEndX - touchStartX;
                
                if (isMobile) {
                    if (swipeDistance > 100 && !sidebar.classList.contains('mobile-open')) {
                        sidebar.classList.add('mobile-open');
                    }
                    
                    if (swipeDistance < -100 && sidebar.classList.contains('mobile-open')) {
                        sidebar.classList.remove('mobile-open');
                    }
                }
            }
            
            window.addEventListener('popstate', function(event) {
                if (isMobile && sidebar.classList.contains('mobile-open')) {
                    sidebar.classList.remove('mobile-open');
                    history.pushState(null, null, window.location.pathname);
                }
            });
            
            history.pushState(null, null, window.location.pathname);
        });
    </script>
</body>
</html>
