<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLAG HUNTER WOLFGUARD</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }

        @keyframes neon-pulse {
            0%, 100% { text-shadow: 0 0 10px #0ff, 0 0 20px #0ff, 0 0 30px #0ff; }
            50% { text-shadow: 0 0 20px #0ff, 0 0 30px #0ff, 0 0 40px #0ff, 0 0 50px #0ff; }
        }

        @keyframes scan {
            0% { top: 0; }
            100% { top: 100%; }
        }

        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }

        @keyframes blink {
            50% { border-color: transparent; }
        }

        @keyframes matrix-rain {
            0% { 
                transform: translateY(-100%); 
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% { 
                transform: translateY(100vh); 
                opacity: 0;
            }
        }

        @keyframes matrix-glow {
            0%, 100% { 
                text-shadow: 0 0 5px #0f0, 0 0 10px #0f0;
            }
            50% { 
                text-shadow: 0 0 10px #0f0, 0 0 20px #0f0, 0 0 30px #0f0;
            }
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #0f0;
            overflow-x: hidden;
            position: relative;
        }

        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
            opacity: 0.2;
        }

        .matrix-char {
            position: absolute;
            color: #0f0;
            font-size: 18px;
            font-weight: bold;
            animation: matrix-rain linear infinite, matrix-glow 2s ease-in-out infinite;
            text-shadow: 0 0 8px #0f0;
        }

        .matrix-char.bright {
            color: #fff;
            font-size: 22px;
            text-shadow: 0 0 15px #0f0, 0 0 25px #0f0;
        }

        .scanline {
            position: fixed;
            width: 100%;
            height: 3px;
            background: linear-gradient(transparent, rgba(0, 255, 0, 0.5), transparent);
            animation: scan 6s linear infinite;
            z-index: 1;
            pointer-events: none;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
        }

        .crt-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.15),
                rgba(0, 0, 0, 0.15) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 3;
            animation: flicker 0.15s infinite;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        .header {
            text-align: center;
            padding: 40px 20px;
            border-bottom: 2px solid #0f0;
            margin-bottom: 40px;
            background: rgba(0, 20, 0, 0.8);
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.3);
        }

        .logo {
            font-size: 48px;
            font-weight: bold;
            color: #0ff;
            animation: neon-pulse 2s ease-in-out infinite;
            text-transform: uppercase;
            letter-spacing: 8px;
            margin-bottom: 10px;
        }

        .logo:hover {
            animation: glitch 0.3s infinite, neon-pulse 2s ease-in-out infinite;
        }

        .subtitle {
            font-size: 16px;
            color: #0f0;
            margin-top: 10px;
            opacity: 0.8;
        }

        .by-hacker {
            font-size: 14px;
            color: #f00;
            margin-top: 15px;
            animation: typing 3s steps(30) infinite alternate;
            white-space: nowrap;
            overflow: hidden;
            border-right: 2px solid #f00;
            display: inline-block;
        }

        .section {
            background: rgba(0, 20, 0, 0.8);
            border: 2px solid #0f0;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
            transition: all 0.3s;
        }

        .section:hover {
            box-shadow: 0 0 40px rgba(0, 255, 0, 0.4);
            transform: translateY(-5px);
        }

        .section-title {
            font-size: 24px;
            color: #0ff;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #0ff;
            border-bottom: 1px solid #0f0;
            padding-bottom: 10px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            color: #0f0;
            margin-bottom: 10px;
            font-size: 14px;
        }

        input[type="file"],
        input[type="text"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            background: #001a00;
            border: 2px solid #0f0;
            color: #0f0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            transition: all 0.3s;
        }

        input[type="file"]:focus,
        input[type="text"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #0ff;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .btn {
            padding: 12px 30px;
            background: #0f0;
            color: #000;
            border: none;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-right: 10px;
            margin-top: 10px;
        }

        .btn:hover {
            background: #0ff;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
            transform: scale(1.05);
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn-secondary {
            background: #f00;
        }

        .btn-secondary:hover {
            background: #ff0;
            box-shadow: 0 0 20px rgba(255, 255, 0, 0.8);
        }

        .results {
            background: #000;
            border: 2px solid #0f0;
            border-radius: 5px;
            padding: 20px;
            margin-top: 20px;
            font-size: 14px;
            line-height: 1.6;
            max-height: 500px;
            overflow-y: auto;
        }

        .results::-webkit-scrollbar {
            width: 10px;
        }

        .results::-webkit-scrollbar-track {
            background: #001a00;
        }

        .results::-webkit-scrollbar-thumb {
            background: #0f0;
            border-radius: 5px;
        }

        .flag-found {
            color: #ff0;
            font-size: 18px;
            font-weight: bold;
            padding: 15px;
            background: rgba(255, 255, 0, 0.1);
            border: 2px solid #ff0;
            border-radius: 5px;
            margin: 10px 0;
            text-shadow: 0 0 10px #ff0;
            animation: neon-pulse 1.5s ease-in-out infinite;
        }

        .loading {
            color: #0ff;
            text-align: center;
            padding: 20px;
            font-size: 16px;
        }

        .loading::after {
            content: '...';
            animation: blink 1.5s infinite;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .card {
            background: rgba(0, 30, 0, 0.6);
            border: 1px solid #0f0;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s;
        }

        .card:hover {
            border-color: #0ff;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
        }

        .badge {
            display: inline-block;
            padding: 3px 8px;
            background: rgba(0, 255, 255, 0.2);
            border: 1px solid #0ff;
            border-radius: 3px;
            font-size: 11px;
            margin-left: 10px;
            color: #0ff;
        }

        .info-box {
            background: rgba(0, 255, 255, 0.1);
            border-left: 4px solid #0ff;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .terminal {
            background: #000;
            border: 2px solid #0f0;
            border-radius: 5px;
            padding: 15px;
            font-size: 13px;
            line-height: 1.6;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
        }

        .terminal-line {
            margin-bottom: 5px;
        }

        .terminal-prompt {
            color: #0ff;
        }

        .terminal-output {
            color: #0f0;
        }

        .terminal-error {
            color: #f00;
        }

        .image-preview {
            max-width: 100%;
            max-height: 400px;
            border: 2px solid #0f0;
            border-radius: 5px;
            margin: 10px 0;
        }

        canvas {
            display: none;
        }

        @media (max-width: 768px) {
            .logo {
                font-size: 32px;
                letter-spacing: 4px;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="matrix-bg" id="matrixBg"></div>
    <div class="scanline"></div>
    <div class="crt-effect"></div>
    
    <div class="container">
        <div class="header">
            <div class="logo">FLAG HUNTER WOLFGUARD</div>
            <div class="subtitle">First Blood</div>
            <div class="by-hacker">BY HACKER MK CONHECIDO COMO 8 A 0 VS PRIDE</div>
        </div>

        <div class="section">
            <div class="section-title">GERADOR DE FLAGS</div>
            <div class="input-group">
                <label>Digite a palavra-chave:</label>
                <input type="text" id="flagInput" placeholder="Ex: oracle, next, challenge, database...">
            </div>
            <button class="btn" onclick="generateFlag()">GERAR FLAG</button>
            <button class="btn btn-secondary" onclick="generateMultipleFlags()">GERAR MÚLTIPLAS</button>
            <div id="flagResults" class="results" style="display:none;"></div>
        </div>

        <div class="section">
            <div class="section-title">ANÁLISE DE IMAGEM - DETECTOR DE LOCAIS</div>
            <div class="input-group">
                <label>Upload imagem para detectar local:</label>
                <input type="file" id="imageFile" accept="image/*">
            </div>
            <button class="btn" onclick="analyzeImageLocation()">DETECTAR LOCAL</button>
            <button class="btn btn-secondary" onclick="reverseImageSearch()">BUSCA REVERSA</button>
            <button class="btn" onclick="extractImageData()">EXTRAIR DADOS</button>
            <div id="imageResults" class="results" style="display:none;"></div>
        </div>

        <div class="section">
            <div class="section-title">ANÁLISE DE PCAP</div>
            <div class="input-group">
                <label>Upload arquivo PCAP/PCAPNG:</label>
                <input type="file" id="pcapFile" accept=".pcap,.pcapng,.cap">
            </div>
            <button class="btn" onclick="analyzePCAP()">ANALISAR PCAP</button>
            <button class="btn btn-secondary" onclick="deepAnalyzePCAP()">ANÁLISE PROFUNDA</button>
            <div id="pcapResults" class="results" style="display:none;"></div>
        </div>

        <div class="section">
            <div class="section-title">ANÁLISE DE ARQUIVOS BINÁRIOS (VMDK, IMG, BIN)</div>
            <div class="input-group">
                <label>Upload arquivo binário:</label>
                <input type="file" id="binaryFile">
            </div>
            <div class="input-group">
                <label>Buscar por:</label>
                <input type="text" id="searchPattern" placeholder="Ex: kernel, password, flag, next, challenge...">
            </div>
            <button class="btn" onclick="analyzeBinary()">ANALISAR ARQUIVO</button>
            <button class="btn btn-secondary" onclick="extractAllStrings()">EXTRAIR TUDO</button>
            <div id="binaryResults" class="results" style="display:none;"></div>
        </div>

        <div class="section">
            <div class="section-title">MK-RESPONDE</div>
            <div class="input-group">
                <label>Buscar informação:</label>
                <textarea id="osintQuery" placeholder="Ex: Piccadilly Circus, Platão, Londres..."></textarea>
            </div>
            <button class="btn" onclick="searchWikipedia()">BUSCAR WIKIPEDIA</button>
            <button class="btn btn-secondary" onclick="searchDuckDuckGo()">BUSCAR WEB</button>
            <div id="osintResults" class="results" style="display:none;"></div>
        </div>

        <div class="section">
            <div class="section-title">DETECTOR UNIVERSAL DE FLAGS</div>
            <div class="input-group">
                <label>Cole qualquer dado (texto, hex, base64, etc):</label>
                <textarea id="rawData" placeholder="Cole aqui..." style="min-height: 150px;"></textarea>
            </div>
            <button class="btn" onclick="detectFlags()">DETECTAR FLAGS</button>
            <button class="btn btn-secondary" onclick="decodeData()">DECODIFICAR</button>
            <div id="detectorResults" class="results" style="display:none;"></div>
        </div>

        <div class="section">
            <div class="section-title">ANÁLISE DE HASHES</div>
            <div class="input-group">
                <label>Cole o hash:</label>
                <input type="text" id="hashInput" placeholder="$1$, $5$, $6$, MD5, SHA...">
            </div>
            <button class="btn" onclick="analyzeHash()">IDENTIFICAR HASH</button>
            <button class="btn btn-secondary" onclick="lookupHash()">BUSCAR ONLINE</button>
            <div id="hashResults" class="results" style="display:none;"></div>
        </div>

        <div class="section">
            <div class="section-title">ESTATÍSTICAS DO SISTEMA</div>
            <div class="grid">
                <div class="card">
                    <div><strong>Status:</strong></div>
                    <div>Sistema <span class="badge">ONLINE</span></div>
                    <div>Gerador <span class="badge">ATIVO</span></div>
                    <div>Análise <span class="badge">REAL-TIME</span></div>
                </div>
                <div class="card">
                    <div><strong>Sessão Atual:</strong></div>
                    <div>Flags: <span id="flagCount">0</span></div>
                    <div>Análises: <span id="analysisCount">0</span></div>
                    <div>Arquivos: <span id="fileCount">0</span></div>
                </div>
                <div class="card">
                    <div><strong>Recursos:</strong></div>
                    <div>✓ Gerador de Flags</div>
                    <div>✓ Detecção de Locais</div>
                    <div>✓ PCAP Analysis</div>
                    <div>✓ Binary Extraction</div>
                    <div>✓ Hash Cracking</div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">CONSOLE DE SISTEMA</div>
            <div class="terminal" id="terminal">
                <div class="terminal-line"><span class="terminal-prompt">[SYSTEM]</span> <span class="terminal-output">FLAG HUNTER v6.0 ULTIMATE</span></div>
                <div class="terminal-line"><span class="terminal-prompt">[INFO]</span> <span class="terminal-output">Gerador de flags ativado</span></div>
                <div class="terminal-line"><span class="terminal-prompt">[INFO]</span> <span class="terminal-output">Detector de locais carregado</span></div>
                <div class="terminal-line"><span class="terminal-prompt">[INFO]</span> <span class="terminal-output">Wikipedia API conectada</span></div>
                <div class="terminal-line"><span class="terminal-prompt">[INFO]</span> <span class="terminal-output">Keywords: next, Next, NEXT, challenge, Challenge, CHALLENGE</span></div>
                <div class="terminal-line"><span class="terminal-prompt">[READY]</span> <span class="terminal-output">Sistema pronto para operação</span></div>
            </div>
        </div>
    </div>

    <canvas id="imageCanvas"></canvas>

    <script>
        let stats = {
            flags: 0,
            analyses: 0,
            files: 0
        };

        const keywordsList = ['next', 'Next', 'NEXT', 'challenge', 'Challenge', 'CHALLENGE', 'oracle', 'Oracle', 'ORACLE'];

        function createMatrixRain() {
            const matrixBg = document.getElementById('matrixBg');
            const chars = '01アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲンABCDEFGHIJKLMNOPQRSTUVWXYZ';
            
            for (let i = 0; i < 120; i++) {
                const char = document.createElement('div');
                char.className = 'matrix-char' + (Math.random() > 0.85 ? ' bright' : '');
                char.textContent = chars[Math.floor(Math.random() * chars.length)];
                char.style.left = Math.random() * 100 + '%';
                char.style.animationDuration = (Math.random() * 2 + 1) + 's';
                char.style.animationDelay = Math.random() * 5 + 's';
                char.style.fontSize = (Math.random() * 8 + 14) + 'px';
                matrixBg.appendChild(char);
            }

            setInterval(() => {
                const chars = matrixBg.children;
                if (chars.length > 0) {
                    const randomChar = chars[Math.floor(Math.random() * chars.length)];
                    randomChar.textContent = '01アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲンABCDEFGHIJKLMNOPQRSTUVWXYZ'[Math.floor(Math.random() * 73)];
                }
            }, 40);
        }

        function addLog(type, message) {
            const terminal = document.getElementById('terminal');
            const line = document.createElement('div');
            line.className = 'terminal-line';
            
            const timestamp = new Date().toLocaleTimeString('pt-BR');
            const typeClass = type === 'ERROR' ? 'terminal-error' : 'terminal-output';
            
            line.innerHTML = `<span class="terminal-prompt">[${timestamp}] [${type}]</span> <span class="${typeClass}">${message}</span>`;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        }

        function updateStats() {
            document.getElementById('flagCount').textContent = stats.flags;
            document.getElementById('analysisCount').textContent = stats.analyses;
            document.getElementById('fileCount').textContent = stats.files;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function generateFlag() {
            const input = document.getElementById('flagInput').value.trim();
            const resultsDiv = document.getElementById('flagResults');
            
            if (!input) {
                alert('Digite uma palavra-chave!');
                return;
            }

            stats.analyses++;
            stats.flags++;
            updateStats();

            resultsDiv.style.display = 'block';
            addLog('INFO', `Gerando flag para: ${input}`);

            let results = '<h3>FLAG GERADA:</h3>';
            results += `<div class="info-box">Input: ${escapeHtml(input)}</div>`;
            results += `<div class="flag-found">flag{${escapeHtml(input)}}</div>`;
            
            results += '<h4 style="color: #0ff;">VARIAÇÕES:</h4>';
            results += `<p style="color: #0f0;">FLAG{${escapeHtml(input)}}</p>`;
            results += `<p style="color: #0f0;">FIAP{${escapeHtml(input)}}</p>`;
            results += `<p style="color: #0f0;">CTF{${escapeHtml(input)}}</p>`;
            results += `<p style="color: #0f0;">${escapeHtml(input).toUpperCase()}</p>`;
            results += `<p style="color: #0f0;">${escapeHtml(input).toLowerCase()}</p>`;
            
            resultsDiv.innerHTML = results;
            addLog('SUCCESS', `Flag gerada: flag{${input}}`);
        }

        function generateMultipleFlags() {
            const input = document.getElementById('flagInput').value.trim();
            const resultsDiv = document.getElementById('flagResults');
            
            if (!input) {
                const keywords = keywordsList;
                resultsDiv.style.display = 'block';
                addLog('INFO', 'Gerando flags para todas as keywords');

                let results = '<h3>FLAGS GERADAS (TODAS KEYWORDS):</h3>';
                
                keywords.forEach(keyword => {
                    results += `<div class="flag-found">flag{${escapeHtml(keyword)}}</div>`;
                    stats.flags++;
                });

                updateStats();
                resultsDiv.innerHTML = results;
                addLog('SUCCESS', `${keywords.length} flags geradas`);
            } else {
                const words = input.split(',').map(w => w.trim()).filter(w => w);
                resultsDiv.style.display = 'block';
                addLog('INFO', `Gerando flags para ${words.length} palavras`);

                let results = '<h3>FLAGS GERADAS (MÚLTIPLAS):</h3>';
                
                words.forEach(word => {
                    results += `<div class="flag-found">flag{${escapeHtml(word)}}</div>`;
                    stats.flags++;
                });

                updateStats();
                resultsDiv.innerHTML = results;
                addLog('SUCCESS', `${words.length} flags geradas`);
            }
        }

        async function analyzeImageLocation() {
            const fileInput = document.getElementById('imageFile');
            const resultsDiv = document.getElementById('imageResults');
            
            if (!fileInput.files || fileInput.files.length === 0) {
                alert('Selecione uma imagem!');
                return;
            }

            const file = fileInput.files[0];
            stats.files++;
            stats.analyses++;
            updateStats();

            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = '<div class="loading">DETECTANDO LOCALIZAÇÃO</div>';
            addLog('INFO', `Analisando: ${file.name}`);

            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    const canvas = document.getElementById('imageCanvas');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0);
                    
                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    const data = imageData.data;
                    
                    let results = `<h3>DETECÇÃO DE LOCAL - ${escapeHtml(file.name)}</h3>`;
                    results += `<img src="${e.target.result}" class="image-preview">`;
                    results += `<div class="info-box">Dimensões: ${img.width}x${img.height}px</div>`;
                    
                    let r = 0, g = 0, b = 0;
                    let edges = 0;
                    
                    for (let i = 0; i < data.length; i += 4) {
                        r += data[i];
                        g += data[i + 1];
                        b += data[i + 2];
                    }
                    
                    const pixelCount = data.length / 4;
                    r = Math.floor(r / pixelCount);
                    g = Math.floor(g / pixelCount);
                    b = Math.floor(b / pixelCount);
                    
                    for (let y = 1; y < img.height - 1; y++) {
                        for (let x = 1; x < img.width - 1; x++) {
                            const i = (y * img.width + x) * 4;
                            const diff = Math.abs(data[i] - data[i + 4]);
                            if (diff > 40) edges++;
                        }
                    }
                    
                    const brightness = (r + g + b) / 3;
                    const edgePercent = (edges / pixelCount) * 100;
                    const saturation = Math.max(r, g, b) - Math.min(r, g, b);
                    const dominantChannel = r > g && r > b ? 'red' : g > b ? 'green' : 'blue';
                    
                    results += '<h4 style="color: #0ff;">ANÁLISE DE LOCAL:</h4>';
                    
                    const locations = {
                        'Londres - Piccadilly Circus': 0,
                        'Londres - Big Ben': 0,
                        'Londres - Tower Bridge': 0,
                        'Paris - Torre Eiffel': 0,
                        'Paris - Arco do Triunfo': 0,
                        'Rio de Janeiro - Cristo Redentor': 0,
                        'Nova York - Times Square': 0,
                        'Nova York - Estátua da Liberdade': 0,
                        'Roma - Coliseu': 0,
                        'Sydney - Opera House': 0,
                        'São Paulo - Av. Paulista': 0,
                        'Egito - Pirâmides': 0
                    };
                    
                    if (dominantChannel === 'blue' && brightness > 150 && saturation > 40) {
                        locations['Londres - Piccadilly Circus'] += 40;
                        locations['Nova York - Times Square'] += 35;
                    }
                    
                    if (dominantChannel === 'blue' && brightness > 140 && edgePercent > 15) {
                        locations['Londres - Tower Bridge'] += 45;
                        locations['Londres - Big Ben'] += 40;
                        locations['Sydney - Opera House'] += 35;
                    }
                    
                    if (brightness > 180 && saturation < 40 && edgePercent > 18) {
                        locations['Paris - Torre Eiffel'] += 50;
                        locations['Paris - Arco do Triunfo'] += 35;
                    }
                    
                    if (dominantChannel === 'blue' && brightness > 160 && edgePercent < 10) {
                        locations['Rio de Janeiro - Cristo Redentor'] += 55;
                    }
                    
                    if (dominantChannel === 'green' && g > 100 && saturation > 30) {
                        locations['Nova York - Estátua da Liberdade'] += 45;
                    }
                    
                    if (brightness > 140 && saturation < 50 && edgePercent > 20) {
                        locations['Roma - Coliseu'] += 40;
                        locations['Egito - Pirâmides'] += 35;
                    }
                    
                    if (edgePercent > 25 && brightness > 120) {
                        locations['São Paulo - Av. Paulista'] += 30;
                        locations['Nova York - Times Square'] += 35;
                    }
                    
                    const sorted = Object.entries(locations).sort((a, b) => b[1] - a[1]);
                    
                    results += '<h4 style="color: #0ff;">LOCAIS DETECTADOS (Por Probabilidade):</h4>';
                    
                    sorted.forEach(([location, score]) => {
                        if (score > 40) {
                            results += `<div class="flag-found">ALTA: ${location} (${score}% confiança)</div>`;
                        } else if (score > 25) {
                            results += `<p style="color: #ff0;">MÉDIA: ${location} (${score}% confiança)</p>`;
                        } else if (score > 10) {
                            results += `<p style="color: #0f0;">BAIXA: ${location} (${score}% confiança)</p>`;
                        }
                    });
                    
                    results += '<h4 style="color: #0ff;">CARACTERÍSTICAS DETECTADAS:</h4>';
                    results += `<p style="color: #0f0;">• Brilho: ${brightness.toFixed(1)} (${brightness > 150 ? 'Claro' : brightness > 100 ? 'Médio' : 'Escuro'})</p>`;
                    results += `<p style="color: #0f0;">• Saturação: ${saturation} (${saturation > 50 ? 'Alta' : saturation > 30 ? 'Média' : 'Baixa'})</p>`;
                    results += `<p style="color: #0f0;">• Detalhes: ${edgePercent.toFixed(1)}% (${edgePercent > 20 ? 'Urbano/Complexo' : edgePercent > 10 ? 'Médio' : 'Simples'})</p>`;
                    results += `<p style="color: #0f0;">• Canal dominante: ${dominantChannel === 'blue' ? 'Azul (céu/água)' : dominantChannel === 'green' ? 'Verde (natureza)' : 'Vermelho'}</p>`;
                    
                    resultsDiv.innerHTML = results;
                    addLog('SUCCESS', 'Análise de localização concluída');
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function reverseImageSearch() {
            const fileInput = document.getElementById('imageFile');
            const resultsDiv = document.getElementById('imageResults');
            
            if (!fileInput.files || fileInput.files.length === 0) {
                alert('Selecione uma imagem!');
                return;
            }

            resultsDiv.style.display = 'block';
            addLog('INFO', 'Abrindo busca reversa...');

            let results = '<h3>BUSCA REVERSA DE IMAGEM:</h3>';
            results += '<p style="color: #0ff;">Faça upload manual da imagem nos links abaixo:</p>';
            results += '<p style="color: #0f0;"><a href="https://images.google.com/" target="_blank" style="color: #0f0;">• Google Images</a></p>';
            results += '<p style="color: #0f0;"><a href="https://yandex.com/images/" target="_blank" style="color: #0f0;">• Yandex Images</a></p>';
            results += '<p style="color: #0f0;"><a href="https://tineye.com/" target="_blank" style="color: #0f0;">• TinEye</a></p>';
            results += '<p style="color: #ff0;">Dica: Essas ferramentas podem identificar o local exato da foto!</p>';
            
            resultsDiv.innerHTML = results;
            addLog('INFO', 'Links de busca reversa preparados');
        }

        async function extractImageData() {
            const fileInput = document.getElementById('imageFile');
            const resultsDiv = document.getElementById('imageResults');
            
            if (!fileInput.files || fileInput.files.length === 0) {
                alert('Selecione uma imagem!');
                return;
            }

            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = '<div class="loading">EXTRAINDO DADOS</div>';
            addLog('INFO', 'Extraindo metadados...');

            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    let results = '<h3>DADOS DA IMAGEM:</h3>';
                    results += `<img src="${e.target.result}" class="image-preview">`;
                    results += '<h4 style="color: #0ff;">INFORMAÇÕES:</h4>';
                    results += `<p style="color: #0f0;">Nome: ${escapeHtml(file.name)}</p>`;
                    results += `<p style="color: #0f0;">Tamanho: ${(file.size / 1024).toFixed(2)} KB</p>`;
                    results += `<p style="color: #0f0;">Tipo: ${file.type}</p>`;
                    results += `<p style="color: #0f0;">Dimensões: ${img.width} x ${img.height} pixels</p>`;
                    results += `<p style="color: #0f0;">Proporção: ${(img.width / img.height).toFixed(2)}</p>`;
                    results += `<p style="color: #0f0;">Modificado: ${new Date(file.lastModified).toLocaleString('pt-BR')}</p>`;
                    
                    results += '<h4 style="color: #0ff;">DICA:</h4>';
                    results += '<p style="color: #ff0;">Para extrair metadados EXIF completos (GPS, câmera, data), use: ExifTool, Jeffrey\'s Image Metadata Viewer, ou MetaPicz</p>';
                    
                    resultsDiv.innerHTML = results;
                    addLog('SUCCESS', 'Dados extraídos');
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        async function analyzePCAP() {
            const fileInput = document.getElementById('pcapFile');
            const resultsDiv = document.getElementById('pcapResults');
            
            if (!fileInput.files || fileInput.files.length === 0) {
                alert('Selecione um arquivo PCAP!');
                return;
            }

            const file = fileInput.files[0];
            stats.files++;
            stats.analyses++;
            updateStats();

            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = '<div class="loading">ANALISANDO PCAP</div>';
            addLog('INFO', `Analisando: ${file.name}`);

            try {
                const arrayBuffer = await file.arrayBuffer();
                const uint8Array = new Uint8Array(arrayBuffer);
                
                let results = `<h3>ANÁLISE PCAP - ${escapeHtml(file.name)}</h3>`;
                results += `<div class="info-box">Tamanho: ${(file.size/1024).toFixed(2)} KB</div>`;

                const strings = extractStringsFromBytes(uint8Array, 4);
                results += `<p style="color: #0ff;">Strings: ${strings.length}</p>`;

                const flagPatterns = [
                    { name: 'FIAP', regex: /FIAP\{[^}]+\}/gi },
                    { name: 'CTF', regex: /CTF\{[^}]+\}/gi },
                    { name: 'FLAG', regex: /FLAG\{[^}]+\}/gi },
                    { name: 'flag', regex: /flag\{[^}]+\}/gi }
                ];

                const allText = strings.join('\n');
                let foundFlags = false;

                for (const pattern of flagPatterns) {
                    const matches = [...new Set(allText.match(pattern.regex) || [])];
                    if (matches.length > 0) {
                        foundFlags = true;
                        results += `<h4 style="color: #0ff;">FLAGS ${pattern.name}:</h4>`;
                        matches.forEach(flag => {
                            results += `<div class="flag-found">FLAG: ${escapeHtml(flag)}</div>`;
                            stats.flags++;
                        });
                    }
                }

                for (const keyword of keywordsList) {
                    const keywordRegex = new RegExp('\\b' + keyword + '\\b', 'g');
                    if (keywordRegex.test(allText)) {
                        results += `<div class="flag-found">KEYWORD ENCONTRADA: ${keyword}</div>`;
                        stats.flags++;
                    }
                }

                const conversations = findTCPConversations(uint8Array, strings);
                if (conversations.length > 0) {
                    results += '<h4 style="color: #0ff;">CONVERSAÇÕES:</h4>';
                    conversations.forEach(conv => {
                        results += `<p style="color: #0f0;">${escapeHtml(conv)}</p>`;
                    });
                }

                const ports = findPorts(uint8Array);
                if (ports.length > 0) {
                    results += '<h4 style="color: #0ff;">PORTAS:</h4>';
                    results += `<p style="color: #0f0;">${ports.join(', ')}</p>`;
                }

                const ips = findIPs(allText);
                if (ips.length > 0) {
                    results += '<h4 style="color: #0ff;">IPs:</h4>';
                    results += `<p style="color: #0f0;">${ips.slice(0, 20).join(', ')}</p>`;
                }

                updateStats();
                resultsDiv.innerHTML = results;
                addLog('SUCCESS', 'Análise concluída');

            } catch (error) {
                resultsDiv.innerHTML = `<p class="terminal-error">ERRO: ${error.message}</p>`;
                addLog('ERROR', error.message);
            }
        }

        async function deepAnalyzePCAP() {
            const fileInput = document.getElementById('pcapFile');
            const resultsDiv = document.getElementById('pcapResults');
            
            if (!fileInput.files || fileInput.files.length === 0) {
                alert('Selecione um arquivo PCAP!');
                return;
            }

            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = '<div class="loading">ANÁLISE PROFUNDA</div>';
            addLog('INFO', 'Análise profunda iniciada...');

            const file = fileInput.files[0];
            const arrayBuffer = await file.arrayBuffer();
            const uint8Array = new Uint8Array(arrayBuffer);

            let results = '<h3>ANÁLISE PROFUNDA:</h3>';

            const allStrings = extractStringsFromBytes(uint8Array, 3);
            results += `<p style="color: #0ff;">Strings: ${allStrings.length}</p>`;

            const interesting = allStrings.filter(s => 
                /pass|senha|flag|key|token|secret|user|admin|hash|next|challenge/i.test(s)
            );

            if (interesting.length > 0) {
                results += '<h4 style="color: #ff0;">STRINGS INTERESSANTES:</h4>';
                interesting.slice(0, 100).forEach(s => {
                    results += `<p style="color: #0f0;">${escapeHtml(s)}</p>`;
                });
            }

            resultsDiv.innerHTML = results;
            addLog('SUCCESS', 'Análise profunda concluída');
        }

        async function analyzeBinary() {
            const fileInput = document.getElementById('binaryFile');
            const pattern = document.getElementById('searchPattern').value;
            const resultsDiv = document.getElementById('binaryResults');
            
            if (!fileInput.files || fileInput.files.length === 0) {
                alert('Selecione um arquivo!');
                return;
            }

            const file = fileInput.files[0];
            stats.files++;
            stats.analyses++;
            updateStats();

            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = '<div class="loading">ANALISANDO BINÁRIO</div>';
            addLog('INFO', `Analisando: ${file.name}`);

            try {
                const arrayBuffer = await file.arrayBuffer();
                const uint8Array = new Uint8Array(arrayBuffer);
                
                let results = `<h3>ANÁLISE BINÁRIA - ${escapeHtml(file.name)}</h3>`;
                results += `<div class="info-box">Tamanho: ${(file.size/1024/1024).toFixed(2)} MB</div>`;

                const strings = extractStringsFromBytes(uint8Array, 4);
                const allText = strings.join('\n');

                if (pattern) {
                    const regex = new RegExp(pattern, 'gi');
                    const matches = allText.match(regex) || [];
                    const uniqueMatches = [...new Set(matches)];

                    results += `<h4 style="color: #0ff;">BUSCA: "${escapeHtml(pattern)}"</h4>`;
                    results += `<p style="color: #0f0;">Ocorrências: ${matches.length}</p>`;

                    if (uniqueMatches.length > 0) {
                        uniqueMatches.slice(0, 50).forEach(match => {
                            const context = getContext(allText, match, 100);
                            results += `<p style="color: #ff0;">${escapeHtml(context)}</p>`;
                        });
                        stats.flags += uniqueMatches.length;
                    }
                }

                for (const keyword of keywordsList) {
                    const keywordRegex = new RegExp('\\b' + keyword + '\\b', 'g');
                    const keyMatches = allText.match(keywordRegex);
                    if (keyMatches) {
                        results += `<div class="flag-found">KEYWORD: ${keyword} (${keyMatches.length}x)</div>`;
                        stats.flags++;
                    }
                }

                const kernelMatch = allText.match(/Linux version ([\d\.]+)/);
                if (kernelMatch) {
                    results += `<div class="flag-found">KERNEL: ${kernelMatch[1]}</div>`;
                    stats.flags++;
                }

                const hashMatches = allText.match(/(\w+):(\$[1256]\$[^\s:]+)/g);
                if (hashMatches) {
                    results += '<h4 style="color: #0ff;">HASHES:</h4>';
                    [...new Set(hashMatches)].forEach(hash => {
                        results += `<div class="flag-found">${escapeHtml(hash)}</div>`;
                        stats.flags++;
                    });
                }

                updateStats();
                resultsDiv.innerHTML = results;
                addLog('SUCCESS', 'Análise concluída');

            } catch (error) {
                resultsDiv.innerHTML = `<p class="terminal-error">ERRO: ${error.message}</p>`;
                addLog('ERROR', error.message);
            }
        }

        async function extractAllStrings() {
            const fileInput = document.getElementById('binaryFile');
            const resultsDiv = document.getElementById('binaryResults');
            
            if (!fileInput.files || fileInput.files.length === 0) {
                alert('Selecione um arquivo!');
                return;
            }

            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = '<div class="loading">EXTRAINDO STRINGS</div>';
            addLog('INFO', 'Extração iniciada...');

            const file = fileInput.files[0];
            const arrayBuffer = await file.arrayBuffer();
            const uint8Array = new Uint8Array(arrayBuffer);
            
            const strings = extractStringsFromBytes(uint8Array, 4);
            const uniqueStrings = [...new Set(strings)].sort((a, b) => b.length - a.length);

            let results = '<h3>STRINGS EXTRAÍDAS:</h3>';
            results += `<p style="color: #0ff;">Total: ${uniqueStrings.length}</p>`;
            
            uniqueStrings.slice(0, 500).forEach(s => {
                const isInteresting = /flag|senha|pass|key|admin|hash|token|next|challenge/i.test(s);
                const color = isInteresting ? '#ff0' : '#0f0';
                results += `<p style="color: ${color};">${escapeHtml(s)}</p>`;
            });

            resultsDiv.innerHTML = results;
            addLog('SUCCESS', `${uniqueStrings.length} strings extraídas`);
        }

        async function searchWikipedia() {
            const query = document.getElementById('osintQuery').value.trim();
            const resultsDiv = document.getElementById('osintResults');
            
            if (!query) {
                alert('Digite algo!');
                return;
            }

            stats.analyses++;
            updateStats();

            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = '<div class="loading">BUSCANDO WIKIPEDIA</div>';
            addLog('INFO', `Buscando: ${query}`);

            try {
                const searchUrl = `https://pt.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(query)}&format=json&origin=*`;
                
                const response = await fetch(searchUrl);
                const data = await response.json();

                let results = '<h3>WIKIPEDIA:</h3>';
                results += `<div class="info-box">Query: ${escapeHtml(query)}</div>`;

                if (data.query && data.query.search && data.query.search.length > 0) {
                    for (const result of data.query.search.slice(0, 5)) {
                        const pageUrl = `https://pt.wikipedia.org/w/api.php?action=query&prop=extracts&exintro&explaintext&pageids=${result.pageid}&format=json&origin=*`;
                        
                        const pageResponse = await fetch(pageUrl);
                        const pageData = await pageResponse.json();
                        const page = pageData.query.pages[result.pageid];

                        results += `<h4 style="color: #0ff;">${escapeHtml(result.title)}</h4>`;
                        
                        if (page.extract) {
                            const extract = page.extract.substring(0, 500);
                            results += `<p style="color: #0f0;">${escapeHtml(extract)}...</p>`;
                        }

                        results += `<p style="color: #0ff;"><a href="https://pt.wikipedia.org/?curid=${result.pageid}" target="_blank" style="color: #0ff;">Ver artigo</a></p>`;
                        results += '<hr style="border-color: #0f0;">';
                    }

                    addLog('SUCCESS', `${data.query.search.length} resultados`);
                } else {
                    results += '<p style="color: #ff0;">Nenhum resultado</p>';
                }

                resultsDiv.innerHTML = results;

            } catch (error) {
                resultsDiv.innerHTML = `<p class="terminal-error">ERRO: ${error.message}</p>`;
                addLog('ERROR', error.message);
            }
        }

        function searchDuckDuckGo() {
            const query = document.getElementById('osintQuery').value.trim();
            
            if (!query) {
                alert('Digite algo!');
                return;
            }

            const searchUrl = `https://duckduckgo.com/?q=${encodeURIComponent(query)}`;
            window.open(searchUrl, '_blank');
            addLog('INFO', 'Busca aberta');
        }

        function detectFlags() {
            const data = document.getElementById('rawData').value;
            const resultsDiv = document.getElementById('detectorResults');
            
            if (!data.trim()) {
                alert('Cole dados!');
                return;
            }

            stats.analyses++;
            updateStats();

            resultsDiv.style.display = 'block';
            addLog('INFO', 'Detectando...');

            let results = '<h3>DETECÇÃO:</h3>';

            const patterns = [
                { name: 'FIAP{...}', regex: /FIAP\{[^}]+\}/gi },
                { name: 'CTF{...}', regex: /CTF\{[^}]+\}/gi },
                { name: 'FLAG{...}', regex: /FLAG\{[^}]+\}/gi },
                { name: 'flag{...}', regex: /flag\{[^}]+\}/gi },
                { name: 'Hash', regex: /\$[1256]\$[^\s:]+/g },
                { name: 'Email', regex: /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g },
                { name: 'IP', regex: /\b(?:\d{1,3}\.){3}\d{1,3}\b/g }
            ];

            let foundSomething = false;

            for (const pattern of patterns) {
                const matches = [...new Set(data.match(pattern.regex) || [])];
                if (matches.length > 0) {
                    foundSomething = true;
                    results += `<h4 style="color: #0ff;">${pattern.name}:</h4>`;
                    matches.forEach(match => {
                        if (pattern.name.includes('FLAG') || pattern.name.includes('FIAP')) {
                            results += `<div class="flag-found">${escapeHtml(match)}</div>`;
                            stats.flags++;
                        } else {
                            results += `<p style="color: #0f0;">${escapeHtml(match)}</p>`;
                        }
                    });
                }
            }

            for (const keyword of keywordsList) {
                if (data.includes(keyword)) {
                    foundSomething = true;
                    results += `<div class="flag-found">KEYWORD: ${keyword}</div>`;
                    stats.flags++;
                }
            }

            if (!foundSomething) {
                results += '<p style="color: #ff0;">Nenhum padrão detectado</p>';
            }

            updateStats();
            resultsDiv.innerHTML = results;
            addLog('SUCCESS', 'Detecção concluída');
        }

        function decodeData() {
            const data = document.getElementById('rawData').value;
            const resultsDiv = document.getElementById('detectorResults');
            
            if (!data.trim()) {
                alert('Cole dados!');
                return;
            }

            resultsDiv.style.display = 'block';

            let results = '<h3>DECODIFICAÇÃO:</h3>';

            try {
                const decoded = atob(data.trim());
                results += '<h4 style="color: #0ff;">BASE64:</h4>';
                results += `<p style="color: #0f0;">${escapeHtml(decoded)}</p>`;
            } catch (e) {}

            try {
                const hexRegex = /^[0-9a-fA-F]+$/;
                if (hexRegex.test(data.trim()) && data.length % 2 === 0) {
                    let str = '';
                    for (let i = 0; i < data.length; i += 2) {
                        str += String.fromCharCode(parseInt(data.substr(i, 2), 16));
                    }
                    results += '<h4 style="color: #0ff;">HEX:</h4>';
                    results += `<p style="color: #0f0;">${escapeHtml(str)}</p>`;
                }
            } catch (e) {}

            resultsDiv.innerHTML = results || '<p style="color: #ff0;">Não foi possível decodificar</p>';
        }

        function analyzeHash() {
            const hash = document.getElementById('hashInput').value.trim();
            const resultsDiv = document.getElementById('hashResults');
            
            if (!hash) {
                alert('Cole um hash!');
                return;
            }

            stats.analyses++;
            updateStats();

            resultsDiv.style.display = 'block';

            let results = '<h3>ANÁLISE:</h3>';
            results += `<div class="info-box">${escapeHtml(hash)}</div>`;

            if (hash.startsWith('$1$')) {
                results += '<p style="color: #0ff;">Tipo: MD5 Crypt</p>';
            } else if (hash.startsWith('$5$')) {
                results += '<p style="color: #0ff;">Tipo: SHA-256 Crypt</p>';
            } else if (hash.startsWith('$6$')) {
                results += '<p style="color: #0ff;">Tipo: SHA-512 Crypt</p>';
            } else if (hash.length === 32) {
                results += '<p style="color: #0ff;">Tipo: MD5</p>';
            } else if (hash.length === 40) {
                results += '<p style="color: #0ff;">Tipo: SHA-1</p>';
            } else if (hash.length === 64) {
                results += '<p style="color: #0ff;">Tipo: SHA-256</p>';
            }

            resultsDiv.innerHTML = results;
            addLog('SUCCESS', 'Hash analisado');
        }

        function lookupHash() {
            window.open('https://crackstation.net/', '_blank');
            addLog('INFO', 'CrackStation aberto');
        }

        function extractStringsFromBytes(bytes, minLength = 4) {
            const strings = [];
            let current = [];
            
            for (let i = 0; i < bytes.length; i++) {
                const byte = bytes[i];
                if (byte >= 32 && byte <= 126) {
                    current.push(byte);
                } else {
                    if (current.length >= minLength) {
                        strings.push(String.fromCharCode(...current));
                    }
                    current = [];
                }
            }
            
            if (current.length >= minLength) {
                strings.push(String.fromCharCode(...current));
            }
            
            return strings;
        }

        function findTCPConversations(bytes, strings) {
            const conversations = [];
            const keywords = ['fala', 'aqui', 'passa', 'flag', 'senha', 'next', 'challenge'];
            
            for (const str of strings) {
                for (const keyword of keywords) {
                    if (str.toLowerCase().includes(keyword)) {
                        conversations.push(str);
                        break;
                    }
                }
            }
            
            return [...new Set(conversations)];
        }

        function findPorts(bytes) {
            const ports = new Set();
            
            for (let i = 0; i < bytes.length - 1; i++) {
                const port = (bytes[i] << 8) | bytes[i + 1];
                if (port > 0 && port <= 65535 && port < 1024) {
                    ports.add(port);
                }
            }
            
            return Array.from(ports).sort((a, b) => a - b);
        }

        function findIPs(text) {
            const ipRegex = /\b(?:\d{1,3}\.){3}\d{1,3}\b/g;
            const ips = text.match(ipRegex) || [];
            return [...new Set(ips)].filter(ip => {
                const parts = ip.split('.');
                return parts.every(p => parseInt(p) <= 255);
            });
        }

        function getContext(text, keyword, length = 50) {
            const idx = text.toLowerCase().indexOf(keyword.toLowerCase());
            if (idx === -1) return keyword;
            
            const start = Math.max(0, idx - length);
            const end = Math.min(text.length, idx + keyword.length + length);
            return text.substring(start, end);
        }

        createMatrixRain();
        addLog('SYSTEM', 'Sistema 100% operacional');
        addLog('INFO', 'Gerador de flags ativo');
        addLog('INFO', 'Detector de locais pronto');
        addLog('READY', 'Aguardando comandos');
    </script>
</body>
</html>
